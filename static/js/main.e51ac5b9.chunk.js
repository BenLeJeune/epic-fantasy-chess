(this.webpackJsonpchessproject=this.webpackJsonpchessproject||[]).push([[0],[,function(e,t,n){"use strict";n.d(t,"a",(function(){return ne}));var a=n(3),r=n(4),c=n(70),i=n(47),o=n(8),s=n(6),u=n(7),l=n(15),d=n(14),f=n(16),g=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).materialValue=3,e.engineValue=330,e.valueGrid=f.a,e.evaluate=function(t){return e.engineValue},e.shortName=n.shortName,e.longName=n.longName,e.movesDescription="Moves any number of squares diagonally.",e.specialMoves=[],e.notes="Is colour-bound.",e.categories=["Minor","Bishop","Colour-bound","FIDE"],e.getLegalMoves=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=[];return r.push.apply(r,Object(o.a)(Object(d.a)(t,e,ne.Bishop*a,[function(e){return 0!==ne.getFile(e)?e+7:e},function(e){return 0!==ne.getFile(e)?e-9:e},function(e){return 7!==ne.getFile(e)?e+9:e},function(e){return 7!==ne.getFile(e)?e-7:e}],n))),r},e}return Object(a.a)(n)}(l.a);g.shortName="B",g.longName="Bishop";var h=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).materialValue=5,e.engineValue=500,e.valueGrid=f.f,e.evaluate=function(t){return e.engineValue},e.shortName=n.shortName,e.longName=n.longName,e.movesDescription="Moves any number of squares diagonally or vertically.",e.specialMoves=['If this starts on the first or eighth file, neither pieces have moved, and this doesn\'t cause the king to move through check, can "castle" with the king.'],e.notes="",e.categories=["Major","Rook","Castler","FIDE"],e.getLegalMoves=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=[];return r.push.apply(r,Object(o.a)(Object(d.a)(t,e,ne.Rook*a,[function(e){return 0!==ne.getRank(e)?e-8:e},function(e){return 0!==ne.getFile(e)?e-1:e},function(e){return 7!==ne.getRank(e)?e+8:e},function(e){return 7!==ne.getFile(e)?e+1:e}],n))),r},e}return Object(a.a)(n)}(l.a);h.shortName="R",h.longName="Rook";var b=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).materialValue=9,e.engineValue=900,e.valueGrid=f.e,e.evaluate=function(t){return e.engineValue},e.shortName=n.shortName,e.longName=n.longName,e.movesDescription="Moves any number of squares diagonally, horizontally and vertically - combining the moves of the Rook and the Bishop.",e.specialMoves=[],e.notes="",e.categories=["Major","Queen","FIDE"],e.getLegalMoves=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=[];return r.push.apply(r,Object(o.a)(Object(d.a)(t,e,ne.Queen*a,[function(e){return 0!==ne.getFile(e)?e+7:e},function(e){return 0!==ne.getFile(e)?e-9:e},function(e){return 7!==ne.getFile(e)?e+9:e},function(e){return 7!==ne.getFile(e)?e-7:e},function(e){return 0!==ne.getRank(e)?e-8:e},function(e){return 0!==ne.getFile(e)?e-1:e},function(e){return 7!==ne.getRank(e)?e+8:e},function(e){return 7!==ne.getFile(e)?e+1:e}],n))),r},e}return Object(a.a)(n)}(l.a);b.shortName="Q",b.longName="Queen";var v=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).materialValue=999,e.engineValue=2e4,e.valueGrid=f.b,e.evaluate=function(t){return e.engineValue},e.shortName=n.shortName,e.longName=n.longName,e.movesDescription="Moves one square in any direction.",e.specialMoves=["If a Castler and this piece have not moved, and you don't pass through check to do so, you may move the king two squares towards the castler, placing the castler on the other side."],e.notes="Cannot move into check, and if possible must move out of check. If checkmated, you lose the game.",e.categories=["Major","King"],e.getLegalMoves=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4?arguments[4]:void 0,c=[];c.push.apply(c,Object(o.a)(Object(d.b)(t,e,ne.King*a,[function(e){return 0!==ne.getFile(e)?e+7:e},function(e){return 0!==ne.getFile(e)?e-9:e},function(e){return 7!==ne.getFile(e)?e+9:e},function(e){return 7!==ne.getFile(e)?e-7:e},function(e){return 0!==ne.getRank(e)?e-8:e},function(e){return 0!==ne.getFile(e)?e-1:e},function(e){return 7!==ne.getRank(e)?e+8:e},function(e){return 7!==ne.getFile(e)?e+1:e}],n)));var i=a>0?4:60,s=a>0?0:56,u=a>0?7:63;if(e===i){var l=r.filter((function(e){return e.moving===ne.King*a||e.captured===ne.King*a}));if(0===l.length){if((t[u]===ne.Rook*a||t[u]===ne.Bede*a)&&t[u-1]===ne.None&&t[u-2]===ne.None){var f=r.filter((function(e){return e.from===u||e.to===u}));0===f.length&&c.push({from:i,to:u-1,special:"CASTLE"})}if(t[s]===ne.Rook*a&&t[s+1]===ne.None&&t[s+2]===ne.None&&t[s+3]===ne.None){var g=r.filter((function(e){return e.from===s||e.to===s}));0===g.length&&c.push({from:i,to:s+2,special:"CASTLE"})}if(t[s]===ne.Bede*a&&t[s+1]===ne.None&&t[s+2]===ne.None&&t[s+3]===ne.None){var h=r.filter((function(e){return e.from===s||e.to===s}));0===h.length&&c.push({from:i,to:s+1,special:"CASTLE"})}}}return c},e}return Object(a.a)(n)}(l.a);v.shortName="K",v.longName="King";var j=n(39),p=n.p+"static/media/pawn_white.50273cc6.svg",m=n.p+"static/media/pawn_black.be5d44ca.svg",O=n.p+"static/media/knight_white.145b8796.svg",y=n.p+"static/media/knight_black.d714eeb4.svg",x=n.p+"static/media/bishop_white.8333f40f.svg",N=n.p+"static/media/bishop_black.629fc057.svg",w=n.p+"static/media/rook_white.ba9ac487.svg",k=n.p+"static/media/rook_black.fd4e01f5.svg",C=n.p+"static/media/queen_white.7a1aecff.svg",T=n.p+"static/media/queen_black.cf388bf4.svg",S=n.p+"static/media/king_white.3f959aab.svg",M=n.p+"static/media/king_black.6c8cc8fa.svg",D=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).materialValue=3,e.engineValue=300,e.valueGrid=f.c,e.evaluate=function(t){return e.engineValue},e.shortName=n.shortName,e.longName=n.longName,e.movesDescription="Can move one square horizontally/vertically, or leap two squares diagonally.",e.specialMoves=[],e.notes="Can leap over pieces.",e.categories=["Minor","Knight","Crusader"],e.getLegalMoves=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=[];return r.push.apply(r,Object(o.a)(Object(d.b)(t,e,ne.Waffle*a,[function(e){return ne.getRank(e)>=1?e-8:e},function(e){return ne.getRank(e)<=6?e+8:e},function(e){return ne.getFile(e)>=1?e-1:e},function(e){return ne.getFile(e)<=6?e+1:e},function(e){return ne.getRank(e)<=5&&ne.getFile(e)<=5?e+18:e},function(e){return ne.getRank(e)<=5&&ne.getFile(e)>=2?e+14:e},function(e){return ne.getRank(e)>=2&&ne.getFile(e)<=5?e-14:e},function(e){return ne.getRank(e)>=2&&ne.getFile(e)>=2?e-18:e}],n))),r},e}return Object(a.a)(n)}(l.a);D.shortName="WA",D.longName="Waffle";var E=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).materialValue=5,e.engineValue=530,e.valueGrid=f.f,e.evaluate=function(t){return e.engineValue},e.shortName=n.shortName,e.longName=n.longName,e.movesDescription="Moves as a bishop, or can leap 2 squares vertically or horizontally.",e.specialMoves=['If neither pieces have moved, and this doesn\'t cause the king to move through check, can "castle" with the king.',"As this piece is colourbound, the king can move up to three squares to keep it on its colour."],e.notes="",e.categories=["Minor","Rook","Crusader"],e.getLegalMoves=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=[];return r.push.apply(r,Object(o.a)((new g).getLegalMoves(e,t,n,a))),r.push.apply(r,Object(o.a)(Object(d.b)(t,e,ne.Bede*a,[function(e){return ne.getRank(e)>=2?e-16:e},function(e){return ne.getRank(e)<=5?e+16:e},function(e){return ne.getFile(e)>=2?e-2:e},function(e){return ne.getFile(e)<=5?e+2:e}],n))),r},e}return Object(a.a)(n)}(l.a);E.shortName="BD",E.longName="Bede";var P=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).materialValue=4,e.engineValue=400,e.valueGrid=f.a,e.evaluate=function(t){return e.engineValue},e.shortName=n.shortName,e.longName=n.longName,e.movesDescription="Can leap two squares vertically or horizontally, or one or two squares diagonally.",e.specialMoves=[],e.notes="Is colour-bound.",e.categories=["Minor","Bishop","Colour-bound","Crusader"],e.getLegalMoves=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=[];return r.push.apply(r,Object(o.a)(Object(d.b)(t,e,ne.Warbishop*a,[function(e){return ne.getRank(e)<=6&&ne.getFile(e)<=6?e+9:e},function(e){return ne.getRank(e)<=6&&ne.getFile(e)>=1?e+7:e},function(e){return ne.getRank(e)>=1&&ne.getFile(e)<=6?e-7:e},function(e){return ne.getRank(e)>=1&&ne.getFile(e)>=1?e-9:e},function(e){return ne.getRank(e)<=5&&ne.getFile(e)<=5?e+18:e},function(e){return ne.getRank(e)<=5&&ne.getFile(e)>=2?e+14:e},function(e){return ne.getRank(e)>=2&&ne.getFile(e)<=5?e-14:e},function(e){return ne.getRank(e)>=2&&ne.getFile(e)>=2?e-18:e},function(e){return ne.getRank(e)>=2?e-16:e},function(e){return ne.getRank(e)<=5?e+16:e},function(e){return ne.getFile(e)>=2?e-2:e},function(e){return ne.getFile(e)<=5?e+2:e}],n))),r},e}return Object(a.a)(n)}(l.a);P.shortName="WB",P.longName="Warbishop";var R=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).materialValue=7,e.engineValue=700,e.valueGrid=f.e,e.evaluate=function(t){return e.engineValue},e.shortName=n.shortName,e.longName=n.longName,e.movesDescription="Moves any number of squares diagonally, or in an L-shape - combining the moves of the Knight and the Bishop.",e.specialMoves=[],e.notes="",e.categories=["Major","Queen","Crusader"],e.getLegalMoves=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=[];return r.push.apply(r,Object(o.a)((new i.a).getLegalMoves(e,t,n,a))),r.push.apply(r,Object(o.a)((new g).getLegalMoves(e,t,n,a))),r},e}return Object(a.a)(n)}(l.a);R.shortName="C",R.longName="Cardinal";var B=n(48),A=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).materialValue=.5,e.engineValue=25,e.valueGrid=f.d,e.evaluate=function(t){return e.engineValue},e.shortName=n.shortName,e.longName=n.longName,e.movesDescription="Moves one square directly forward.",e.specialMoves=[],e.notes="Cannot capture or promote",e.categories=["Minor","Pawn","Token"],e.getLegalMoves=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=[];return"captures"!==n&&(1===ne.getRank(e)||6===ne.getRank(e)?r.push.apply(r,Object(o.a)(Object(d.a)(t,e,ne.Pawn*a,[function(e){return a>0?e+8:e-8}],"moves",2).map((function(e){return 16===Math.abs(e.from-e.to)?Object(B.a)(Object(B.a)({},e),{},{special:"DOUBLE"}):e})))):r.push.apply(r,Object(o.a)(Object(d.b)(t,e,ne.Pawn*a,[function(e){return a>0?e+8:e-8}],"moves")))),r},e}return Object(a.a)(n)}(l.a);A.shortName="\xacP",A.longName="Dummy Pawn";var I=n.p+"static/media/bede_white.56fa5c65.svg",L=n.p+"static/media/bede_black.528c2b5e.svg",F=n.p+"static/media/waffle_white.ac9ddbc0.svg",H=n.p+"static/media/waffle_black.b8e5c779.svg",V=n.p+"static/media/warbishop_white.59df694b.svg",_=n.p+"static/media/warbishop_black.84a414c3.svg",q=n.p+"static/media/cardinal_white.abc22523.svg",J=n.p+"static/media/cardinal_black.b169cd4e.svg",W=n.p+"static/media/dummy_pawn_white.07ade20e.svg",U=n.p+"static/media/dummy_pawn_black.acf683a9.svg",K=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).materialValue=4,e.engineValue=400,e.valueGrid=f.f,e.evaluate=function(t){return e.engineValue},e.shortName=n.shortName,e.longName=n.longName,e.movesDescription="Leaps exactly 2 squares in any direction, or makes 1 move rookwise.",e.specialMoves=[],e.notes="",e.categories=["Minor","Unique","Omega"],e.getLegalMoves=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=[];return r.push.apply(r,Object(o.a)(Object(d.b)(t,e,ne.Bede*a,[function(e){return ne.getRank(e)>=2?e-16:e},function(e){return ne.getRank(e)<=5?e+16:e},function(e){return ne.getFile(e)>=2?e-2:e},function(e){return ne.getFile(e)<=5?e+2:e},function(e){return ne.getRank(e)<=5&&ne.getFile(e)<=5?e+18:e},function(e){return ne.getRank(e)<=5&&ne.getFile(e)>=2?e+14:e},function(e){return ne.getRank(e)>=2&&ne.getFile(e)<=5?e-14:e},function(e){return ne.getRank(e)>=2&&ne.getFile(e)>=2?e-18:e},function(e){return ne.getRank(e)>=1?e-8:e},function(e){return ne.getRank(e)<=6?e+8:e},function(e){return ne.getFile(e)>=1?e-1:e},function(e){return ne.getFile(e)<=6?e+1:e}],n))),r},e}return Object(a.a)(n)}(l.a);K.shortName="CH",K.longName="Champion";var G=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).materialValue=4,e.engineValue=460,e.valueGrid=f.c,e.evaluate=function(t){return e.engineValue},e.shortName=n.shortName,e.longName=n.longName,e.movesDescription="Leaps in an elongated knight move, three squares in one direction then one square perpendicular. Can also move one square diagonally.",e.specialMoves=[],e.notes="",e.categories=["Minor","Unique","Omega"],e.getLegalMoves=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=[];return r.push.apply(r,Object(o.a)(Object(d.b)(t,e,ne.Bede*a,[function(e){return ne.getFile(e)>=3?e+5:e},function(e){return ne.getFile(e)<=4?e-5:e},function(e){return ne.getFile(e)<=4?e+11:e},function(e){return ne.getFile(e)>=3?e-11:e},function(e){return ne.getFile(e)>=1?e+23:e},function(e){return ne.getFile(e)<=6?e-23:e},function(e){return ne.getFile(e)<=6?e+25:e},function(e){return ne.getFile(e)>=1?e-25:e},function(e){return ne.getRank(e)<=6&&ne.getFile(e)<=6?e+9:e},function(e){return ne.getRank(e)<=6&&ne.getFile(e)>=1?e+7:e},function(e){return ne.getRank(e)>=1&&ne.getFile(e)<=6?e-7:e},function(e){return ne.getRank(e)>=1&&ne.getFile(e)>=1?e-9:e}],n))),r},e}return Object(a.a)(n)}(l.a);G.shortName="WI",G.longName="Wizard";var Y=n(11),z=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).materialValue=3,e.engineValue=350,e.valueGrid=f.a,e.evaluate=function(t){return e.engineValue},e.shortName=n.shortName,e.longName=n.longName,e.movesDescription="Moves as the piece your opponent last moved.",e.specialMoves=[],e.notes="Ignores card-based moves. Cannot move if your opponent hasn't moved a piece yet.",e.categories=["Minor","Unique","Omega"],e.getLegalMoves=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4?arguments[4]:void 0,c=[],i=Object(o.a)(r).reverse().filter((function(e){return Object(Y.a)(e.moving,a)})).filter((function(e){return!e.additional.hasOwnProperty("isCardMove")&&Math.abs(e.moving)!==ne.Jester}));if(i.length>=1){var s=i[0],u=ne.getPiece(s.moving);u&&c.push.apply(c,Object(o.a)(u.getLegalMoves(e,t,n,a,r)))}return c},e}return Object(a.a)(n)}(l.a);z.shortName="J",z.longName="Jester";var Q=n.p+"static/media/champion_white.a993ecde.svg",X=n.p+"static/media/champion_black.7801b11e.svg",Z=n.p+"static/media/wizard_white.dd2b757b.svg",$=n.p+"static/media/wizard_black.5c90220e.svg",ee=n.p+"static/media/jester_white.5a769867.svg",te=n.p+"static/media/jester_black.d3196538.svg",ne=Object(a.a)((function e(){Object(r.a)(this,e)}));ne.PIECES=[1,2,3,4,5,6,7,8,9,10,11,12,13,14],ne.PIECE_OBJECTS=[null,new c.a,new i.a,new g,new h,new b,new v,new D,new P,new E,new R,new A,new K,new G,new z],ne.None=0,ne.Pawn=1,ne.Knight=2,ne.Bishop=3,ne.Rook=4,ne.Queen=5,ne.King=6,ne.Waffle=7,ne.Warbishop=8,ne.Bede=9,ne.Cardinal=10,ne.DummyPawn=11,ne.Champion=12,ne.Wizard=13,ne.Jester=14,ne.isWhite=function(e){return e>0},ne.isBlack=function(e){return e<0},ne.getFile=function(e){return e%8},ne.getRank=function(e){return(e-e%8)/8},ne.getSquareName=function(e){return"".concat(j.a[ne.getFile(e)]).concat(ne.getRank(e)+1)},ne.getStyle=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{gridRow:t?"".concat(1+ne.getRank(e),"/").concat(2+ne.getRank(e)):"".concat(8-ne.getRank(e),"/").concat(9-ne.getRank(e)),gridColumn:t?"".concat(8-ne.getFile(e),"/").concat(9-ne.getFile(e)):"".concat(ne.getFile(e)+1,"/").concat(ne.getFile(e)+2)}},ne.getImage=function(e){switch(Math.abs(e)){case 0:return"";case ne.Pawn:return e>0?p:m;case ne.Knight:return e>0?O:y;case ne.Bishop:return e>0?x:N;case ne.Rook:return e>0?w:k;case ne.Queen:return e>0?C:T;case ne.King:return e>0?S:M;case ne.Waffle:return e>0?F:H;case ne.Warbishop:return e>0?V:_;case ne.Bede:return e>0?I:L;case ne.Cardinal:return e>0?q:J;case ne.DummyPawn:return e>0?W:U;case ne.Champion:return e>0?Q:X;case ne.Wizard:return e>0?Z:$;case ne.Jester:return e>0?ee:te}},ne.getPiece=function(e){return ne.PIECE_OBJECTS[Math.abs(e)]}},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(3),r=n(4),c=n(87),i=Object(a.a)((function e(){var t=this;Object(r.a)(this,e),this.cardName=void 0,this.shortName=void 0,this.description=void 0,this.id=void 0,this.expac=void 0,this.targets=void 0,this.fast=void 0,this.cost=void 0,this.unMoveType=void 0,this.getValidTargets=void 0,this.playCard=void 0,this.trackPiece=function(e){return e},this.uuid=Object(c.a)(),this.getUUID=function(){return t.uuid},this.getUUIDWithInfo=function(){return"".concat(t.id,"::").concat(t.uuid)},this.regenerateUUID=function(){return t.uuid=Object(c.a)()}}));i.id=void 0},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));var a="FIDE",r="Crusaders"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var a=function(e,t){return e>0&&t<0||e<0&&t>0},r=function(e,t){return e>0&&t>0||e<0&&t<0}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return c}));var a="myArmies",r="myDecks",c="myGames"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var a=n(72),r=n(1),c=n(11),i=function(e,t,n,a,r){return o(e,t,n,a,r,1)},o=function(e,t,n,i,o){var s,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8,l=[],d=Object(a.a)(i);try{for(d.s();!(s=d.n()).done;)for(var f=s.value,g=f(t),h=!1,b=0;!h&&g<=63&&g>=0&&b<u;)e[g]===r.a.None?"captures"!==o&&l.push({from:t,to:g}):Object(c.a)(n,e[g])?("moves"!==o&&l.push({from:t,to:g}),h=!0):h=!0,h||(g===f(g)&&(h=!0),g=f(g),b++)}catch(v){d.e(v)}finally{d.f()}return l}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(3),r=n(4),c=Object(a.a)((function e(){Object(r.a)(this,e),this.engineValue=void 0,this.materialValue=void 0,this.valueGrid=void 0,this.evaluate=void 0,this.shortName=void 0,this.longName=void 0,this.movesDescription=void 0,this.specialMoves=void 0,this.notes=void 0,this.categories=void 0,this.getLegalMoves=function(e,t,n){return t.map((function(t,n){return n!==e&&0===t?{from:e,to:n}:null})).filter((function(e){return null!==e}))}}))},function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return s}));var a=[0,0,0,0,0,0,0,0,50,50,50,50,50,50,50,50,10,10,20,30,30,20,10,10,5,5,10,25,25,10,5,5,0,0,0,20,20,0,0,0,5,-5,-10,0,0,-10,-5,5,5,10,10,-20,-20,10,10,5,0,0,0,0,0,0,0,0],r=[-50,-40,-30,-30,-30,-30,-40,-50,-40,-20,0,0,0,0,-20,-40,-30,0,10,15,15,10,0,-30,-30,5,15,20,20,15,5,-30,-30,0,15,20,20,15,0,-30,-30,5,10,15,15,10,5,-30,-40,-20,0,5,5,0,-20,-40,-50,-40,-30,-30,-30,-30,-40,-50],c=[-20,-10,-10,-10,-10,-10,-10,-20,-10,0,0,0,0,0,0,-10,-10,0,5,10,10,5,0,-10,-10,5,5,10,10,5,5,-10,-10,0,10,10,10,10,0,-10,-10,10,10,10,10,10,10,-10,-10,5,0,0,0,0,5,-10,-20,-10,-10,-10,-10,-10,-10,-20],i=[0,0,0,0,0,0,0,0,5,10,10,10,10,10,10,5,-5,0,0,0,0,0,0,-5,-5,0,0,0,0,0,0,-5,-5,0,0,0,0,0,0,-5,-5,0,0,0,0,0,0,-5,-5,0,0,0,0,0,0,-5,0,0,5,5,5,5,0,0],o=[-20,-10,-10,-5,-5,-10,-10,-20,-10,0,0,0,0,0,0,-10,-10,0,5,5,5,5,0,-10,-5,0,5,5,5,5,0,-5,0,0,5,5,5,5,0,-5,-10,5,5,5,5,5,0,-10,-10,0,5,0,0,0,0,-10,-20,-10,-10,-5,-5,-10,-10,-20],s=[-30,-40,-40,-50,-50,-40,-40,-30,-30,-40,-40,-50,-50,-40,-40,-30,-30,-40,-40,-50,-50,-40,-40,-30,-30,-40,-40,-50,-50,-40,-40,-30,-20,-30,-30,-40,-40,-30,-30,-20,-10,-20,-20,-20,-20,-20,-20,-10,20,20,0,0,0,0,20,20,20,30,10,0,0,10,30,20]},function(e,t,n){"use strict";var a,r=n(12),c=n(50),i=n(51),o=n(52),s=n(37),u=n(53),l=n(60),d=n(61),f=n(62),g=n(63),h=n(64),b=n(54),v=n(55),j=n(65),p=n(41),m=n(66),O=n(67),y=n(68),x=n(56),N=n(57),w=n(42),k=(a={},Object(r.a)(a,i.a.id,new i.a),Object(r.a)(a,c.a.id,new c.a),Object(r.a)(a,o.a.id,new o.a),Object(r.a)(a,s.a.id,new s.a),Object(r.a)(a,u.a.id,new u.a),Object(r.a)(a,l.a.id,new l.a),Object(r.a)(a,h.a.id,new h.a),Object(r.a)(a,d.a.id,new d.a),Object(r.a)(a,f.a.id,new f.a),Object(r.a)(a,g.a.id,new g.a),Object(r.a)(a,b.a.id,new b.a),Object(r.a)(a,v.a.id,new v.a),Object(r.a)(a,x.a.id,new x.a),Object(r.a)(a,N.a.id,new N.a),Object(r.a)(a,w.a.id,new w.a),Object(r.a)(a,y.a.id,new y.a),Object(r.a)(a,j.a.id,new j.a),Object(r.a)(a,p.a.id,new p.a),Object(r.a)(a,m.a.id,new m.a),Object(r.a)(a,O.a.id,new O.a),a);new w.a;t.a=k},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n(2);var a=n(28),r=(n(107),n(0));function c(e){var t,n=e.onClick,c=e.text,i=e.buttonStyle,o=void 0===i?"small":i,s=e.disabled,u=void 0!==s&&s,l=e.highlight,d=void 0!==l&&l;return t=Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:"niceButtonBackground ".concat(o)}),Object(r.jsx)("div",{className:"niceButtonForeground ".concat(o," ").concat(u?"disabled":""," ").concat(d?"highlight":""),children:Object(r.jsx)("p",{children:c})})]}),"function"===typeof n?Object(r.jsx)("div",{className:"niceButtonOuter ".concat(o),onClick:function(){return u?null:n()},children:t}):Object(r.jsx)(a.b,{to:n,children:Object(r.jsx)("div",{className:"niceButtonOuter ".concat(o),children:t})})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(3),r=n(4),c=n(39),i=n(1),o=n(70),s=Object(a.a)((function e(t,n,a,s){var u=this,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.NONE,d=arguments.length>5?arguments[5]:void 0,f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};Object(r.a)(this,e),this.from=void 0,this.to=void 0,this.moving=void 0,this.captured=void 0,this.specify=void 0,this.special=void 0,this.additional=void 0,this.getMoveName=function(){var t,n;if(null===i.a.getPiece(u.moving))return u.additional.isCardMove&&"PROMOTION"===u.special&&u.additional.promotionTo?"".concat(c.a[i.a.getFile(u.to)]+i.a.getRank(u.to),"+").concat(null===(n=i.a.getPiece(u.additional.promotionTo))||void 0===n?void 0:n.shortName):"ERR";var a=i.a.getPiece(u.moving),r=a.shortName===o.a.shortName?"":a.shortName,s=u.captured===i.a.None?"":"x",l=i.a.getSquareName(u.to),d="";u.specify!==e.FILE&&u.specify!==e.BOTH||(d+=c.a[i.a.getFile(u.from)]),u.specify!==e.RANK&&u.specify!==e.BOTH||(d+=i.a.getRank(u.from));var f=u.additional&&u.additional.promotionTo?"=".concat(null===(t=i.a.getPiece(u.additional.promotionTo))||void 0===t?void 0:t.shortName):"";return"".concat(r).concat(d).concat(s).concat(l).concat(f)},this.from=t,this.to=n,this.moving=a,this.captured=s,this.specify=l,this.special=d,this.additional=f}));s.NONE=0,s.RANK=1,s.FILE=2,s.BOTH=3},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(36);var a=n(19),r=function(e){return e.filter((function(e){return e instanceof a.a}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1),r=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=[],r=a.a.getRank(e),c=a.a.getFile(e);return r<=6&&(n.push(e+8),t&&(c>=1&&n.push(e+7),c<=6&&n.push(e+9))),r>=1&&(n.push(e-8),t&&(c>=1&&n.push(e-9),c<=6&&n.push(e-7))),c>=1&&n.push(e-1),c<=6&&n.push(e+1),n}},function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return g}));var a=n(8),r=n(1),c=n(19),i=n(35),o=n(49),s=n(34),u=n(11),l=n(17),d=n(22),f=function(e,t,n,a){var c=e.indexOf(r.a.King),o=e.indexOf(-r.a.King);if(-1===c||-1===o)return!1;var s=n>0?c:o;return a||(a=i.a.getLegalMoves(e,t,{mode:"captures",colour:-n})),a.filter((function(e){return e.to===s})).length>0},g=function e(t,n,r,c){var i=new o.a(t.getBoard(),Object(d.a)(t.getMoves()),t.getWhiteDeck(),t.getBlackDeck());t.getCurrentOngoingEffects().forEach((function(e){return i.addOngoingEffect(new s.a(e.getSquare(),e.getName(),e.getDurationRemaining(),"",e.getTarget()))}));var u=!1,g=l.a[n];r.length===g.targets?(i.PlayCard(l.a[n],r),u=f(i.getBoard(),Object(d.a)(i.getMoves()),c),i.UnMove()):u=!g.getValidTargets[0](i.getBoard(),c,Object(d.a)(i.getMoves()),r,i.getCurrentOngoingEffects()).reduce((function(t,o){return e(i,n,[].concat(Object(a.a)(r),[o]),c)||t}),!1);return!u},h=function(e,t,n,a,l){var d=new o.a(t,n);return l.forEach((function(e){return d.addOngoingEffect(new s.a(e.getSquare(),e.getName(),e.getDurationRemaining(),e.getToolTip(),e.getTarget()))})),e.filter((function(e){if(l.filter((function(e){return"no-captures"===e.getName()})).filter((function(n){return n.getSquare()===e.from&&t[e.to]!==r.a.None})).length>0)return!1;if(l.filter((function(e){return"no-captures"===e.getName()})).filter((function(n){return n.getSquare()===e.to&&t[e.to]!==r.a.None})).length>0)return!1;if(l.filter((function(e){return"no-moves"===e.getName()})).filter((function(t){return t.getSquare()===e.from})).length>0)return!1;var o=l.filter((function(e){return"must-move"===e.getName()})).filter((function(n){return n.getSquare()!==e.from&&Object(u.b)(a,t[n.getSquare()])}));if(o.length>0){var s=t[o[0].getSquare()],g=r.a.getPiece(s);if(g){var h=g.getLegalMoves(o[0].getSquare(),t,"all",a,n).reduce((function(e,t){if(e)return!0;d.Move(t.from,t.to,t.special);var n=f(d.getBoard(),d.getMoves().filter((function(e){return e instanceof c.a})),a);return d.UnMove(),!n||e}),!1);if(h)return!1}}if("CASTLE"===e.special){if(f(d.getBoard(),n,a))return!1;var b=a>0?7:63,v=a>0?0:56;if(e.to===b-1&&i.a.isThreatened(b-2,d.getBoard(),n,-a))return!1;if(e.to===v+2&&i.a.isThreatened(v+3,d.getBoard(),n,-a))return!1}d.Move(e.from,e.to,e.special);var j=f(d.getBoard(),d.getMoves().filter((function(e){return e instanceof c.a})),a);return d.UnMove(),!j}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u}));var a=n(3),r=n(4),c=n(1),i=Object(a.a)((function e(t,n){Object(r.a)(this,e),this.pieces=void 0,this.name=void 0,this.pieces=t,this.name=n})),o=new i([c.a.Rook,c.a.Knight,c.a.Bishop,c.a.Queen,c.a.King,c.a.Bishop,c.a.Knight,c.a.Rook],"FIDE Army"),s=new i([c.a.Bede,c.a.Waffle,c.a.Warbishop,c.a.Cardinal,c.a.King,c.a.Warbishop,c.a.Waffle,c.a.Bede],"Colourbound Crusaders"),u=new i([c.a.Wizard,c.a.Jester,c.a.Champion,c.a.Queen,c.a.King,c.a.Champion,c.a.Jester,c.a.Wizard],"dev-army")},function(e,t,n){"use strict";n.d(t,"c",(function(){return k})),n.d(t,"d",(function(){return C})),n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return S}));var a=n(3),r=n(4),c=n(50),i=n(51),o=n(52),s=n(37),u=n(53),l=n(60),d=n(61),f=n(62),g=n(63),h=n(54),b=n(55),v=n(56),j=n(57),p=n(42),m=n(68),O=n(65),y=n(41),x=n(66),N=n(67),w=n(64),k=Object(a.a)((function e(t,n){Object(r.a)(this,e),this.cards=void 0,this.name=void 0,this.cards=t,this.name=n})),C=new k([i.a.id,i.a.id,c.a.id,c.a.id,o.a.id,o.a.id,s.a.id,s.a.id,u.a.id,u.a.id,l.a.id,w.a.id,d.a.id,f.a.id,g.a.id],"FIDE Deck"),T=new k([h.a.id,h.a.id,b.a.id,b.a.id,v.a.id,v.a.id,j.a.id,j.a.id,p.a.id,p.a.id,m.a.id,O.a.id,y.a.id,x.a.id,N.a.id],"Colourbound Crusaders Deck"),S=new k([s.a.id,s.a.id,y.a.id,y.a.id],"FIDE Deck")},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(5),r=n(2),c=n(18),i=(n(115),n(33)),o=(n(116),n(117),n(0));function s(e){var t=e.text;return Object(o.jsxs)("div",{title:"Click to Copy",className:"textCopy",onClick:function(e){return function(e){e.preventDefault(),e.stopPropagation(),navigator.clipboard.writeText(t)}(e)},children:[Object(o.jsx)("div",{className:"scrollContainer",children:t}),Object(o.jsxs)("div",{className:"icon",children:[Object(o.jsx)("span",{className:"material-symbols-outlined",children:"content_copy"}),Object(o.jsx)("div",{className:"background"})]})]})}var u;n(118);function l(e){var t=e.text,n=e.onChange;return Object(o.jsx)("div",{className:"textInput",children:Object(o.jsx)("div",{className:"scrollContainer",children:Object(o.jsx)("input",{type:"text",value:t,onChange:function(e){return n(e)}})})})}function d(e){var t=e.shown,n=e.popupRef,d=Object(r.useContext)(i.b),f=d.Conn,g=d.Channel,h=(d.setListener,d.initChannel),b=Object(r.useState)(u.none),v=Object(a.a)(b,2),j=v[0],p=v[1],m=Object(r.useState)(),O=Object(a.a)(m,2),y=O[0],x=O[1],N=Object(r.useState)(""),w=Object(a.a)(N,2),k=w[0],C=w[1],T=function(e){C(e.target.value)},S=Object(r.useRef)([]);Object(r.useEffect)((function(){f.addEventListener("icecandidate",(function(e){e.candidate&&(console.log("Found ICE candidate \n",e.candidate),S.current.push(e.candidate))})),f.addEventListener("icegatheringstatechange",(function(e){console.log("ice gathering state change: \n",f.iceGatheringState)})),f.addEventListener("connectionstatechange",(function(e){console.log("Connection state change: ",f.connectionState)})),window.DEV_SEND_MSG=function(e){g.send(e),console.log("sent message ",e)}}),[g,f]);var M=function(e){return console.log(e)},D=function(e){p(e?u.local:u.remote),f.onicecandidate=function(e){if(e.candidate)console.log(e.candidate.candidate);else{var t;console.log("iceGatheringState complete\n",null===(t=f.localDescription)||void 0===t?void 0:t.sdp);var n=JSON.stringify(f.localDescription),a=JSON.stringify(S.current);console.log("Candidates: \n",a),x(function(e,t){return btoa(encodeURIComponent(e)+"|"+encodeURIComponent(t))}(n,a))}},e&&(h(),f.createOffer().then((function(e){console.log("createOffer ok"),f.setLocalDescription(e).then((function(){}))}))),f.ondatachannel=function(e){console.group("Received Channel: ".concat(e.channel.id)),console.log("Currently channel ".concat(null===g||void 0===g?void 0:g.id,": \n"),g),h(e.channel),console.groupEnd()}},E=function(){var e=atob(k).split("|").map((function(e){return decodeURIComponent(e)})),t=Object(a.a)(e,2),n=t[0],r=t[1],c=JSON.parse(n),i=new RTCSessionDescription(c),o=JSON.parse(r);console.log("Received offer from remote: \n",i),console.log("Received ice candidates: \n",r),f.setRemoteDescription(i).then((function(){console.log("Set the remote description"),"offer"===i.type&&f.createAnswer().then((function(e){console.log("createAnswer ok \n",e),f.setLocalDescription(e).then((function(){}))})).catch(M)})).catch(M),console.log(o);try{o.forEach((function(e){f.addIceCandidate(e).then((function(){console.log("Adding ice candidate: \n",e)}))}))}catch(s){console.log("Failed to assign ice candidates \n",s)}};return Object(o.jsxs)("div",{className:t?"shown":"hidden",id:"ConnectingPopup",children:[Object(o.jsx)("div",{id:"PopupBackground"}),Object(o.jsxs)("div",{id:"ConnectionPopupBubble",ref:n,children:[Object(o.jsx)("h1",{children:f.connectionState}),Object(o.jsxs)("div",{className:"section",children:[Object(o.jsx)("p",{children:"In order to play online, you have to connect directly to another server. This can be done by creating an offer."}),Object(o.jsx)("p",{children:"Either player can create the first offer."}),Object(o.jsxs)("div",{className:"row",children:[Object(o.jsx)(c.a,{disabled:j!==u.none,highlight:j===u.local,onClick:function(){return D(!0)},text:"Create an Offer"}),Object(o.jsx)(c.a,{disabled:j!==u.none,highlight:j===u.remote,onClick:function(){return D(!1)},text:"Recieve an Offer"})]})]}),j!==u.local?null:Object(o.jsxs)("div",{className:"section",children:[Object(o.jsx)("label",{children:"Your Offer"}),Object(o.jsx)(s,{text:y||"ERROR - view browser console"}),Object(o.jsx)("p",{children:"Copy this string, and send it to your opponent. Ask them to send theirs back, and enter it into the field below!"}),Object(o.jsx)("label",{children:"Remote Offer"}),Object(o.jsx)(l,{text:k,onChange:function(e){return T(e)}}),Object(o.jsx)(c.a,{disabled:""===k,onClick:function(){return E()},text:"Connect!"})]}),j!==u.remote?null:Object(o.jsxs)("div",{className:"section",children:[Object(o.jsx)("label",{children:"Remote Offer"}),Object(o.jsx)(l,{text:k,onChange:function(e){return T(e)}}),Object(o.jsx)("p",{children:"Enter the description you've been given, then send your opponent yours!"}),Object(o.jsx)("label",{children:"Your Offer"}),Object(o.jsx)(s,{text:y||"ERROR - view browser console"}),Object(o.jsx)(c.a,{disabled:""===k,onClick:function(){return E()},text:"Generate Answer"})]})]})]})}function f(e){var t=e.fixed,n=void 0===t||t,s=Object(r.useContext)(i.b).Conn,u=Object(r.useRef)(null),l=Object(r.useState)(!1),f=Object(a.a)(l,2),g=f[0],h=f[1];return Object(o.jsxs)(o.Fragment,{children:[" ",Object(o.jsxs)("div",{id:"NavBar",style:n?{}:{position:"absolute"},children:[Object(o.jsx)("h3",{className:"navBarHeader",children:"Epic Fantasy Chess"}),Object(o.jsx)(c.a,{onClick:"/",text:"HOME",buttonStyle:"small"}),Object(o.jsx)(c.a,{onClick:"/play",text:"PLAY",buttonStyle:"small"}),Object(o.jsx)(c.a,{onClick:"/armies",text:"ARMIES",buttonStyle:"small"}),Object(o.jsx)(c.a,{onClick:"/decks",text:"DECKS",buttonStyle:"small"}),Object(o.jsx)("div",{id:"ConnectionManager",onClick:function(e){return function(e){e.preventDefault(),e.stopPropagation(),h(!0),window.addEventListener("click",(function e(t){if(u.current){var n,a=null===(n=u.current)||void 0===n?void 0:n.getBoundingClientRect(),r=a.x,c=a.y,i=a.height,o=a.width;if(r<t.x&&t.x<r+o&&c<t.y&&t.y<c+i)return;h(!1),window.removeEventListener("click",e)}}))}(e)},children:function(){switch(s.connectionState){case"new":case"closed":return"not connected";default:return s.connectionState}}()})]}),Object(o.jsx)(d,{shown:g,popupRef:u})]})}!function(e){e[e.none=0]="none",e[e.local=1]="local",e[e.remote=2]="remote"}(u||(u={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=function(e){return e[Math.floor(Math.random()*e.length)]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=n.n(a),c={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},i=new RTCPeerConnection(c),o=i.createDataChannel("dataChannel");o.onopen=function(){console.log("data channel opened!")},o.onclose=function(){console.log("data channel closed!")};var s=r.a.createContext({Conn:i,Channel:o,initChannel:function(){},setListener:function(e){o?o.onmessage=e:console.log("Tried to attach listener but no data channel exists.")}});t.b=s},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(3),r=n(4),c=Object(a.a)((function e(t,n,a,c){var i=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"piece";Object(r.a)(this,e),this.affecting=void 0,this.name=void 0,this.initialDuration=void 0,this.durationRemaining=void 0,this.toolTip=void 0,this.target=void 0,this.getSquare=function(){return i.affecting},this.getName=function(){return i.name},this.getInitialDuration=function(){return i.initialDuration},this.getDurationRemaining=function(){return i.durationRemaining},this.getToolTip=function(){return i.toolTip},this.getTarget=function(){return i.target},this.updateSquare=function(e){return i.affecting=e},this.tickDownDuration=function(){return i.durationRemaining--},this.unTickDuration=function(){return i.durationRemaining++},this.affecting=t,this.name=n,this.initialDuration=a,this.durationRemaining=a,this.toolTip=c,this.target=o}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(8),r=n(5),c=n(3),i=n(4),o=n(1),s=Object(c.a)((function e(){Object(i.a)(this,e)}));s.getLegalMoves=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=Object.assign({mode:"all",colour:0,ignore:[]},n),i=[];return e.map((function(e,t){return[e,t]})).filter((function(e){return e[0]>0&&c.colour>0||e[0]<0&&c.colour<0})).filter((function(e){var t=Object(r.a)(e,2),n=(t[0],t[1]);return-1===c.ignore.indexOf(n)})).forEach((function(n){var s=Object(r.a)(n,2),u=s[0],l=s[1];if(u!==o.a.None){var d=o.a.getPiece(u);if(null!==d){var f=d.getLegalMoves(l,e,c.mode,c.colour,t);i.push.apply(i,Object(a.a)(f))}}})),i},s.isThreatened=function(e,t,n,a){return s.getThreats(e,t,n,a).length>0},s.getThreats=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-t[e];return s.getLegalMoves(t,n,{mode:"all",colour:a}).filter((function(t){return t.to===e}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(3),r=n(4),c=n(17),i=Object(a.a)((function e(t,n,a){var i=this;Object(r.a)(this,e),this.cardName=void 0,this.boardBefore=void 0,this.targets=void 0,this.getMoveName=function(){return c.a[i.cardName].shortName},this.cardName=t,this.boardBefore=n,this.targets=a,-1===Object.keys(c.a).indexOf(t)&&console.log("Warning - creating a CardMove using a non-existant card!")}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(5),r=n(3),c=n(4),i=n(6),o=n(7),s=n(9),u=n(1),l=n(11),d=n(23),f=n(10),g=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).cardName="Reposition",e.description="Swap 2 adjacent friendly pieces",e.targets=2,e.fast=!1,e.cost=8,e.shortName="_Rpos",e.id=n.id,e.expac=f.b,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return a&&0!==a.length?e.forEach((function(e,n){e!==u.a.None&&Object(l.b)(e,t)&&-1!==Object(d.a)(a?a[0]:n).indexOf(n)&&r.push(n)})):e.forEach((function(n,a){n!==u.a.None&&Object(l.b)(n,t)&&Object(d.a)(a).filter((function(t){return Object(l.b)(n,e[t])})).length>0&&r.push(a)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){var n=Object(a.a)(e,2),r=n[0],c=n[1];t.updateGameBoard((function(e){var t=e[r],n=e[c];e[r]=n,e[c]=t}))},e.trackPiece=function(t,n){if(n.length===e.targets){var r=Object(a.a)(n,2),c=r[0],i=r[1];if(t===c)return i;if(t===i)return c}return t},e}return Object(r.a)(n)}(s.a);g.id="reposition"},function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return g}));var a=n(6),r=n(7),c=n(3),i=n(4),o=Object(c.a)((function e(){Object(i.a)(this,e),this.msgType=void 0,this.payload=void 0})),s=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).msgType="ready",e.payload={},e}return Object(c.a)(n)}(o),u=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this)).msgType="setup_choice",a.payload=void 0,a.payload=e,a}return Object(c.a)(n)}(o),l=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this)).msgType="game_start_request",a.payload=void 0,a.payload=e,a}return Object(c.a)(n)}(o),d=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this)).msgType="game_start_response",a.payload=void 0,a.payload=e,a}return Object(c.a)(n)}(o),f=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this)).msgType="piece_move",a.payload=void 0,a.payload=e,a}return Object(c.a)(n)}(o),g=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this)).msgType="card_move",a.payload=void 0,a.payload=e,a}return Object(c.a)(n)}(o)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=["a","b","c","d","e","f","g","h"]},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return i}));var a=n(1),r=function(){for(var e=[],t=0;t<=63;t++)e.push(0);return e},c=function(){for(var e=r(),t=8;t<=15;t++)e[t]=a.a.Pawn,e[63-t]=-a.a.Pawn;return e[0]=a.a.Rook,e[7]=a.a.Rook,e[56]=-a.a.Rook,e[63]=-a.a.Rook,e[1]=a.a.Knight,e[6]=a.a.Knight,e[57]=-a.a.Knight,e[62]=-a.a.Knight,e[2]=a.a.Bishop,e[5]=a.a.Bishop,e[58]=-a.a.Bishop,e[61]=-a.a.Bishop,e[3]=a.a.Queen,e[59]=-a.a.Queen,e[4]=a.a.King,e[60]=-a.a.King,e},i=function(e,t){var n=r();e.pieces.map((function(e,t){return n[t]=e})),t.pieces.map((function(e,t){return n[56+t]=-1*e}));for(var c=8;c<=15;c++)n[c]=a.a.Pawn,n[63-c]=-a.a.Pawn;return n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(5),r=n(3),c=n(4),i=n(6),o=n(7),s=n(9),u=n(1),l=n(11),d=n(10),f=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).cardName="Deception",e.description="Swap any 2 friendly pieces",e.targets=2,e.fast=!1,e.cost=12,e.shortName="_Dcep",e.id=n.id,e.expac=d.a,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return e.forEach((function(e,n){e!==u.a.None&&Object(l.b)(e,t)&&r.push(n)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){var n=Object(a.a)(e,2),r=n[0],c=n[1];t.updateGameBoard((function(e){var t=e[r],n=e[c];e[r]=n,e[c]=t}))},e.trackPiece=function(t,n){if(n.length===e.targets){var r=Object(a.a)(n,2),c=r[0],i=r[1];if(t===c)return i;if(t===i)return c}return t},e}return Object(r.a)(n)}(s.a);f.id="deception"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(3),r=n(4),c=n(6),i=n(7),o=n(9),s=n(1),u=n(11),l=n(34),d=n(10),f=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).cardName="Oust",e.description="Choose a non-king enemy piece. Your opponent must move it next turn (if possible).",e.targets=1,e.fast=!0,e.cost=3,e.shortName="_Oust",e.id=n.id,e.expac=d.a,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return e.forEach((function(e,n){e===s.a.None||e===-t*s.a.King||Object(u.b)(e,t)||r.push(n)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){e.forEach((function(e){t.addOngoingEffect(new l.a(e,"must-move",1,"This piece is being ousted. It must be moved on its next turn (if possible)."))}))},e}return Object(a.a)(n)}(o.a);f.id="oust"},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(8),r=n(3),c=n(4),i=n(6),o=n(7),s=n(15),u=n(14),l=n(1),d=n(16),f=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).materialValue=3,e.engineValue=320,e.valueGrid=d.c,e.evaluate=function(t){return e.engineValue},e.shortName=n.shortName,e.longName=n.longName,e.movesDescription="Two squares in one direction, then one perpendicular, forming an L-shape.",e.specialMoves=[],e.notes="Can leap over pieces.",e.categories=["Minor","Knight","FIDE"],e.getLegalMoves=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,c=[];return c.push.apply(c,Object(a.a)(Object(u.b)(t,e,l.a.Knight*r,[function(e){return l.a.getFile(e)>=2?e+6:e},function(e){return l.a.getFile(e)>=2?e-10:e},function(e){return l.a.getFile(e)<=5?e+10:e},function(e){return l.a.getFile(e)<=5?e-6:e},function(e){return l.a.getFile(e)>=1?e+15:e},function(e){return l.a.getFile(e)<=6?e-15:e},function(e){return l.a.getFile(e)<=6?e+17:e},function(e){return l.a.getFile(e)>=1?e-17:e}],n))),c},e}return Object(r.a)(n)}(s.a);f.shortName="N",f.longName="Knight"},,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var a=n(8),r=n(3),c=n(4),i=n(40),o=n(19),s=n(36),u=n(1),l=n(17),d=n(26),f=n(32),g=n(22),h=Object(r.a)((function t(){var n=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(i.c)(),h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d.d,v=arguments.length>3&&void 0!==arguments[3]?arguments[3]:d.d;Object(c.a)(this,t),this.board=void 0,this.currentTurn=void 0,this.moves=void 0,this.gameLength=void 0,this.whiteHand=void 0,this.blackHand=void 0,this.whiteDeck=void 0,this.blackDeck=void 0,this.whiteCurrentDeck=void 0,this.blackCurrentDeck=void 0,this.ongoingEffects=void 0,this.UnMove=function(){var e=n.moves.pop();if(e instanceof o.a){if(n.moves=Object(a.a)(n.moves),void 0===e)return;var t=e.moving>0?1:-1;switch("EP"!==e.special&&(n.board[e.to]=e.captured),n.board[e.from]=e.moving,n.getCurrentOngoingEffects().filter((function(t){return t.getSquare()===e.to&&"piece"===t.getTarget()})).forEach((function(t){return t.updateSquare(e.from)})),e.special){case"EP":n.board[e.to]=u.a.None,n.board[e.to-8*t]=e.captured;break;case"PROMOTION":break;case"CASTLE":if(e.from>e.to){var r=0;Math.abs(n.board[e.to+1])===u.a.Rook?r=2:Math.abs(n.board[e.to+1])===u.a.Bede&&(r=1);var c=e.to-r;n.board[c]=n.board[e.to+1],n.board[e.to+1]=u.a.None}if(e.from<e.to){var i=e.to+1;n.board[i]=n.board[e.to-1],n.board[e.to-1]=u.a.None}}e.additional.isCardMove?n.UnMove():n.undoEndOfTurnCheck()}if(e instanceof s.a){n.board.forEach((function(t,a){t!==e.boardBefore[a]&&(n.board[a]=e.boardBefore[a])}));var d=Object.assign({},l.a[e.cardName]);d.regenerateUUID(),n.currentTurn<0?n.whiteHand.push(d):n.blackHand.push(d);var f=l.a[e.cardName],g=[];n.ongoingEffects.forEach((function(e,t){e.getDurationRemaining()===e.getInitialDuration()&&g.push(t)})),n.ongoingEffects=n.ongoingEffects.filter((function(e,t){return-1===g.indexOf(t)})),f&&!f.fast&&n.undoEndOfTurnCheck()}},this.Move=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=n.board[e]>0?1:-1,i=o.a.NONE,s=n.board[e],l=t===e?u.a.None:n.board[t];switch(Math.abs(n.board[e])===u.a.Pawn&&0!==n.board[t]&&(i=o.a.FILE),a){case"EP":l=n.board[t-8*c],n.board[t-8*c]=u.a.None;break;case"PROMOTION":if(r.hasOwnProperty("promotionTo")&&void 0!==r.promotionTo){var d=r.promotionTo;n.board[e]=d}break;case"CASTLE":if(e>t){var f=t;Math.abs(n.board[t-2])===u.a.Rook&&n.board[t-1]===u.a.None?f-=2:Math.abs(n.board[t-1])===u.a.Bede&&(f-=1),n.board[t+1]=n.board[f],n.board[f]=u.a.None}if(e<t){var g=t+1;n.board[t-1]=n.board[g],n.board[g]=u.a.None}}n.moves.push(new o.a(e,t,s,l,i,a,r)),n.board[t]=n.board[e],t!==e&&(n.board[e]=u.a.None),n.getCurrentOngoingEffects().filter((function(t){return t.getSquare()===e&&"piece"===t.getTarget()})).forEach((function(e){e.updateSquare(t)})),r.isCardMove||n.endOfTurnCheck()},this.endOfTurnCheck=function(){n.currentTurn<0&&n.gameLength++,n.currentTurn=-n.currentTurn,n.checkForCardDraw(),n.ongoingEffects.forEach((function(e){return e.tickDownDuration()}))},this.undoEndOfTurnCheck=function(){n.currentTurn>0&&n.gameLength--,n.currentTurn=-n.currentTurn,n.checkForUndoCardDraw(),n.ongoingEffects.forEach((function(e,t){e.unTickDuration()}))},this.checkForCardDraw=function(){n.gameLength%3===0&&n.currentTurn>0&&(n.whiteCurrentDeck.length>0&&n.DrawCard(1),n.blackCurrentDeck.length>0&&n.DrawCard(-1))},this.checkForUndoCardDraw=function(){if((n.gameLength+1)%3===0&&n.currentTurn<0&&n.whiteHand.length>0&&n.blackHand.length>0){var e=n.whiteHand.pop(),t=n.blackHand.pop();n.whiteCurrentDeck.push(e),n.blackCurrentDeck.push(t)}},this.PlayCard=function(e,t){if(e)if(t.length===e.targets){var r=Object(a.a)(n.board),c=new s.a(e.id,r,t);if(n.moves.push(c),e.playCard(t,n),n.currentTurn>0){var i=n.whiteHand.map((function(e){return e.getUUID()})).indexOf(e.getUUID());n.whiteHand=n.whiteHand.filter((function(e,t){return t!==i}))}else{var o=n.blackHand.map((function(e){return e.getUUID()})).indexOf(e.getUUID());n.blackHand=n.blackHand.filter((function(e,t){return t!==o}))}e.fast||n.endOfTurnCheck()}else console.log("Tried to play a card with the improper amount of targets");else console.log("Tried to play a card that does not exist!")},this.DrawCard=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e>0)for(var a=function(e){var t=Number.parseInt(Object(f.a)(Object.keys(n.whiteCurrentDeck)));n.whiteHand.push(n.whiteCurrentDeck[t]),n.whiteCurrentDeck=n.whiteCurrentDeck.filter((function(e,n){return n!==t}))},r=0;r<t;r++)a(r);else for(var c=function(e){var t=Number.parseInt(Object(f.a)(Object.keys(n.blackCurrentDeck)));n.blackHand.push(n.blackCurrentDeck[t]),n.blackCurrentDeck=n.blackCurrentDeck.filter((function(e,n){return n!==t}))},i=0;i<t;i++)c(i)},this.getBoard=function(){return n.board},this.getMoves=function(){return n.moves},this.getCurrentTurn=function(){return n.currentTurn},this.getWhiteHand=function(){return n.whiteHand},this.getBlackHand=function(){return n.blackHand},this.getCurrentPlayerHand=function(){return n.currentTurn>0?n.whiteHand:n.blackHand},this.getChaosScore=function(){return Object(g.a)(n.moves).reduce((function(e,t){return u.a.getPiece(t.captured)?e+u.a.getPiece(t.captured).materialValue:e}),0)},this.getWhiteCurrentDeck=function(){return n.whiteCurrentDeck},this.getBlackCurrentDeck=function(){return n.blackCurrentDeck},this.getWhiteDeck=function(){return n.whiteDeck},this.getBlackDeck=function(){return n.blackDeck},this.getCurrentPlayerCurrentDeck=function(){return n.currentTurn>0?n.whiteCurrentDeck:n.blackCurrentDeck},this.getNonCurrentPlayerCurrentDeck=function(){return n.currentTurn>0?n.blackCurrentDeck:n.whiteCurrentDeck},this.getOngoingEffects=function(){return n.ongoingEffects},this.getCurrentOngoingEffects=function(){return n.ongoingEffects.filter((function(e){return e.getDurationRemaining()>=0}))},this.addOngoingEffect=function(e){return n.ongoingEffects.push(e)},this.getLastMove=function(){return n.moves.length>0?n.moves[n.moves.length-1]:void 0},this.dangerouslySetCurrentTurn=function(e){return n.currentTurn=e},this.setWhiteHand=function(e){return n.whiteHand=e(n.whiteHand)},this.setBlackHand=function(e){return n.blackHand=e(n.blackHand)},this.updateGameBoard=function(e){return e(n.board)},this.board=Object(a.a)(r),this.moves=h,this.currentTurn=1,this.gameLength=1,this.whiteHand=[],this.blackHand=[],this.whiteDeck=b,this.blackDeck=v,this.whiteCurrentDeck=this.whiteDeck.cards.map((function(e){var t=Object.assign({},l.a[e]);return t.regenerateUUID(),t})),this.blackCurrentDeck=this.blackDeck.cards.map((function(e){var t=Object.assign({},l.a[e]);return t.regenerateUUID(),t})),this.DrawCard(1,2),this.DrawCard(-1,3),this.whiteHand=this.whiteHand.map((function(e){var t=Object.assign({},e);return t.regenerateUUID(),t})),this.blackHand=this.blackHand.map((function(e){var t=Object.assign({},e);return t.regenerateUUID(),t})),this.ongoingEffects=[],e.window&&(e.window.updateBoard=function(e){return e(n.board).map((function(e,t){return n.board[t]=e}))},e.window.ADD_CARD_TO_HAND=function(e){l.a[e]&&(n.currentTurn>0?n.whiteHand.push(l.a[e]):n.blackHand.push(l.a[e]))})}))}).call(this,n(77))},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(3),r=n(4),c=n(6),i=n(7),o=n(9),s=n(1),u=n(11),l=n(23),d=n(10),f=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).cardName="Expendable",e.description="Summon a pawn adjacent to a friendly piece.",e.targets=1,e.fast=!1,e.cost=4,e.shortName="_Expd",e.id=n.id,e.expac=d.b,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return e.forEach((function(n,a){n===s.a.None&&Object(l.a)(a).filter((function(n){return Object(u.b)(t,e[n])})).length>0&&r.push(a)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){e.forEach((function(e){t.Move(e,e,"PROMOTION",{isCardMove:!0,promotionTo:s.a.Pawn*t.getCurrentTurn()})}))},e}return Object(a.a)(n)}(o.a);f.id="expendable"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(3),r=n(4),c=n(6),i=n(7),o=n(9),s=n(1),u=n(10),l=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).cardName="Advance",e.description="Move 2 pawns forward one.",e.targets=2,e.fast=!1,e.cost=0,e.shortName="_Advn",e.id=n.id,e.expac=u.b,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return e.forEach((function(n,a){n===s.a.Pawn*t&&s.a.getRank(a)!==(t>0?7:0)&&e[a+8*t]===s.a.None&&r.push(a)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){e.forEach((function(e){t.Move(e,e+8*t.getCurrentTurn(),void 0,{isCardMove:!0})}))},e}return Object(a.a)(n)}(o.a);l.id="advance"},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(3),r=n(4),c=n(6),i=n(7),o=n(9),s=n(1),u=n(11),l=n(10),d=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).cardName="Tactical Retreat",e.description="Move a piece back 2 squares.",e.targets=1,e.fast=!0,e.cost=5,e.shortName="_Tcrt ",e.id=n.id,e.expac=l.b,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return e.forEach((function(n,a){Object(u.b)(n,t)&&(t>0&&s.a.getRank(a)>=2||t<0&&s.a.getRank(a)<=5)&&e[a-8*t]===s.a.None&&e[a-16*t]===s.a.None&&r.push(a)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){e.forEach((function(e){t.Move(e,e-16*t.getCurrentTurn(),void 0,{isCardMove:!0})}))},e}return Object(a.a)(n)}(o.a);d.id="tactical-retreat"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(3),r=n(4),c=n(6),i=n(7),o=n(9),s=n(1),u=n(10),l=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).cardName="Mount",e.description="A friendly pawn promotes into a knight.",e.targets=1,e.fast=!1,e.cost=10,e.shortName="_Moun",e.id=n.id,e.expac=u.b,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return e.forEach((function(e,n){e===s.a.Pawn*t&&r.push(n)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){e.forEach((function(e){t.Move(e,e,"PROMOTION",{isCardMove:!0,promotionTo:s.a.Knight*t.getCurrentTurn()})}))},e}return Object(a.a)(n)}(o.a);l.id="mount"},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(5),r=n(3),c=n(4),i=n(6),o=n(7),s=n(9),u=n(1),l=n(11),d=n(23),f=n(10),g=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).cardName="Adjust",e.description="A piece makes one move rookwise",e.targets=2,e.fast=!1,e.cost=0,e.shortName="_Adjs",e.id=n.id,e.expac=f.a,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];if(a&&a[0]){var c=a[0];Object(d.a)(c,!1).forEach((function(t){e[t]===u.a.None&&r.push(t)}))}else e.forEach((function(n,a){Object(l.b)(n,t)&&Object(d.a)(a,!1).filter((function(t){return e[t]===u.a.None})).length>0&&r.push(a)}));return r}],e.playCard=function(e,t){var n=Object(a.a)(e,2),r=n[0],c=n[1];t.Move(r,c,void 0,{isCardMove:!0})},e}return Object(r.a)(n)}(s.a);g.id="adjust"},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(5),r=n(3),c=n(4),i=n(6),o=n(7),s=n(9),u=n(1),l=n(10),d=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).cardName="Inquisition",e.description="A pawn moves forward 2",e.targets=1,e.fast=!1,e.cost=0,e.shortName="_Inqu",e.id=n.id,e.expac=l.a,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return e.forEach((function(n,a){n===u.a.Pawn*t&&e[a+16*t]===u.a.None&&r.push(a)})),r}],e.playCard=function(e,t){var n=Object(a.a)(e,1)[0],r=t.getCurrentTurn();t.Move(n,n+16*r,"DOUBLE",{isCardMove:!0})},e}return Object(r.a)(n)}(s.a);d.id="inquisition"},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(3),r=n(4),c=n(6),i=n(7),o=n(9),s=n(1),u=n(34),l=n(10),d=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).cardName="Hallow",e.description="A non-king piece cannot capture or be captured for 1 turn.",e.targets=1,e.fast=!0,e.cost=2,e.shortName="_Hlow",e.id=n.id,e.expac=l.a,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return e.forEach((function(e,t){e!==s.a.None&&Math.abs(e)!==s.a.King&&r.push(t)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){e.forEach((function(e){t.addOngoingEffect(new u.a(e,"no-captures",1,"This piece has been hallowed, and cannot capture or be captured."))}))},e}return Object(a.a)(n)}(o.a);d.id="hallow"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(3),r=n(4),c=n(6),i=n(7),o=n(9),s=n(1),u=n(11),l=n(34),d=n(10),f=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).cardName="Repent",e.description="Choose a non-king enemy piece. Your opponent cannot move it next turn.",e.targets=1,e.fast=!0,e.cost=2,e.shortName="_Rpnt",e.id=n.id,e.expac=d.a,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return e.forEach((function(e,n){e===s.a.None||e===-t*s.a.King||Object(u.b)(e,t)||r.push(n)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){e.forEach((function(e){t.addOngoingEffect(new l.a(e,"no-moves",1,"This piece is repenting. It cannot be moved normally (Can still be moved by cards)."))}))},e}return Object(a.a)(n)}(o.a);f.id="repent"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(3),r=n(4),c=n(6),i=n(7),o=n(9),s=n(1),u=n(11),l=n(10),d=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).cardName="Demote",e.description="An opposing minor piece demotes to a pawn.",e.targets=1,e.fast=!1,e.cost=12,e.shortName="_Dmot",e.id=n.id,e.expac=l.b,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return e.forEach((function(e,n){var a,c;-1!==(null===(a=s.a.getPiece(e))||void 0===a?void 0:a.categories.indexOf("Minor"))&&-1===(null===(c=s.a.getPiece(e))||void 0===c?void 0:c.categories.indexOf("Pawn"))&&Object(u.a)(t,e)&&r.push(n)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){e.forEach((function(e){t.Move(e,e,"PROMOTION",{isCardMove:!0,promotionTo:-s.a.Pawn*t.getCurrentTurn()})}))},e}return Object(a.a)(n)}(o.a);d.id="demote"},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(5),r=n(3),c=n(4),i=n(6),o=n(7),s=n(9),u=n(1),l=n(11),d=n(47),f=n(10),g=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).cardName="Maneuver",e.description="A bishop makes a knight move.",e.targets=2,e.fast=!1,e.cost=15,e.shortName="_Mnvr",e.id=n.id,e.expac=f.b,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];if(a&&0!==a.length){var c=(new d.a).getLegalMoves(a[0],e,"moves",t);e.forEach((function(e,t){c.filter((function(e){return e.to===t})).length>0&&r.push(t)}))}else e.forEach((function(e,n){var a;Object(l.b)(e,t)&&-1!==(null===(a=u.a.getPiece(e))||void 0===a?void 0:a.categories.indexOf("Bishop"))&&r.push(n)}));return r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){var n=Object(a.a)(e,2),r=n[0],c=n[1];t.Move(r,c,void 0,{isCardMove:!0})},e}return Object(r.a)(n)}(s.a);g.id="maneuver"},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(5),r=n(3),c=n(4),i=n(6),o=n(7),s=n(9),u=n(1),l=n(11),d=n(23),f=n(10),g=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).cardName="Flee",e.description="Your king moves to a square adjacent to a friendly piece.",e.targets=2,e.fast=!1,e.cost=25,e.shortName="_Flee",e.id=n.id,e.expac=f.b,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return a&&0!==a.length?e.forEach((function(n,a){n===u.a.None&&Object(d.a)(a).filter((function(n){return Object(l.b)(t,e[n])&&Math.abs(e[n])!==u.a.King})).length>0&&r.push(a)})):e.forEach((function(e,n){var a;Object(l.b)(e,t)&&-1!==(null===(a=u.a.getPiece(e))||void 0===a?void 0:a.categories.indexOf("King"))&&r.push(n)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){var n=Object(a.a)(e,2),r=n[0],c=n[1];t.Move(r,c,void 0,{isCardMove:!0})},e}return Object(r.a)(n)}(s.a);g.id="flee"},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(3),r=n(4),c=n(6),i=n(7),o=n(9),s=n(1),u=n(14),l=n(10),d=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).cardName="Promotion",e.description="A friendly pawn advances as far up its file as possible. If it reaches the back rank, it becomes a Rook.",e.targets=1,e.fast=!1,e.cost=30,e.shortName="_Prmo",e.id=n.id,e.expac=l.b,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return e.forEach((function(n,a){n===s.a.Pawn*t&&e[a+8*t]===s.a.None&&r.push(a)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){e.forEach((function(e){var n=Object(u.a)(t.getBoard(),e,t.getBoard()[e],[function(e){return e+8*t.getCurrentTurn()}],"moves");if(n.length>=1){var a=n[n.length-1];7===s.a.getRank(a.to)&&t.getCurrentTurn()>0||0===s.a.getRank(a.to)&&t.getCurrentTurn()<0?t.Move(e,a.to,"PROMOTION",{isCardMove:!0,promotionTo:s.a.Rook*t.getCurrentTurn()}):t.Move(e,a.to,void 0,{isCardMove:!0})}else console.log("RIDER RETURNED 0 RIDER MOVES")}))},e}return Object(a.a)(n)}(o.a);d.id="promotion"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(3),r=n(4),c=n(6),i=n(7),o=n(9),s=n(10),u=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).cardName="Battle Plan",e.description="Draw 3 cards",e.targets=1,e.fast=!1,e.cost=12,e.shortName="_BPln",e.id=n.id,e.expac=s.b,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return e.forEach((function(e,t){return r.push(t)})),r}],e.playCard=function(e,t){var n=t.getCurrentTurn();t.DrawCard(n,3)},e}return Object(a.a)(n)}(o.a);u.id="battleplan"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(3),r=n(4),c=n(6),i=n(7),o=n(9),s=n(1),u=n(10),l=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).cardName="Anoint",e.description="A friendly pawn promotes into a bishop.",e.targets=1,e.fast=!1,e.cost=11,e.shortName="_Anoi",e.id=n.id,e.expac=u.a,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return e.forEach((function(e,n){e===s.a.Pawn*t&&r.push(n)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){e.forEach((function(e){t.Move(e,e,"PROMOTION",{isCardMove:!0,promotionTo:s.a.Bishop*t.getCurrentTurn()})}))},e}return Object(a.a)(n)}(o.a);l.id="anonit"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(3),r=n(4),c=n(6),i=n(7),o=n(9),s=n(1),u=n(11),l=n(23),d=n(10),f=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).cardName="Clergy",e.description="Summon 2 pawns next to each other",e.targets=2,e.fast=!1,e.cost=15,e.shortName="_Clrg",e.id=n.id,e.expac=d.a,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return a&&0!==a.length?e.forEach((function(e,t){e===s.a.None&&-1!==Object(l.a)(a?a[0]:t).indexOf(t)&&r.push(t)})):e.forEach((function(n,a){n===s.a.None&&Object(l.a)(a).filter((function(n){return Object(u.b)(t,e[n])})).length>0&&r.push(a)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){t.updateGameBoard((function(n){e.forEach((function(e){t.Move(e,e,"PROMOTION",{isCardMove:!0,promotionTo:s.a.Pawn*t.getCurrentTurn()})}))}))},e}return Object(a.a)(n)}(o.a);f.id="clergy"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(3),r=n(4),c=n(6),i=n(7),o=n(9),s=n(1),u=n(11),l=n(24),d=n(10),f=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).cardName="Convert",e.description="Choose an enemy piece you can capture. You take control of it instead.",e.targets=1,e.fast=!1,e.cost=18,e.shortName="_Convt",e.id=n.id,e.expac=d.a,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a,r){var c=[];return e.forEach((function(a,i){Object(u.b)(a,t)&&s.a.getPiece(a)&&Object(l.b)(s.a.getPiece(a).getLegalMoves(i,e,"captures",t,n),e,n,t,r||[]).forEach((function(e){c.push(e.to)}))})),c.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){t.updateGameBoard((function(t){e.forEach((function(e){t[e]=-t[e]}))}))},e}return Object(a.a)(n)}(o.a);f.id="convert"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(3),r=n(4),c=n(6),i=n(7),o=n(9),s=n(1),u=n(11),l=n(23),d=n(10),f=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).cardName="Envoy",e.description="Summon a dummy pawn that cannot capture or promote adjacent to a friendly piece",e.targets=1,e.fast=!0,e.cost=5,e.shortName="_Envy",e.id=n.id,e.expac=d.a,e.unMoveType="boardState",e.getValidTargets=[function(e,t,n,a){var r=[];return e.forEach((function(n,a){n===s.a.None&&Object(l.a)(a).filter((function(n){return Object(u.b)(t,e[n])})).length>0&&r.push(a)})),r.filter((function(e){return!a||0===a.length||-1===a.indexOf(e)}))}],e.playCard=function(e,t){t.updateGameBoard((function(n){e.forEach((function(e){n[e]=s.a.DummyPawn*(t.getCurrentTurn()>0?1:-1)}))}))},e}return Object(a.a)(n)}(o.a);f.id="envoy"},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(36),r=n(19),c=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var c=t[0],i=0,o=t;i<o.length;i++){var s=o[i];if(s instanceof r.a&&c instanceof r.a){if(s.to!==c.to||s.from!==c.from||s.moving!==c.moving||s.captured!==c.captured||s.special!==c.special)return!1}else if(s instanceof a.a&&c instanceof a.a)return!1}return!0}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(48),r=n(8),c=n(3),i=n(4),o=n(6),s=n(7),u=n(15),l=n(14),d=n(1),f=n(16),g=function(e){Object(o.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(i.a)(this,n);for(var c=arguments.length,o=new Array(c),s=0;s<c;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).materialValue=1,e.engineValue=100,e.valueGrid=f.d,e.evaluate=function(t){return e.engineValue},e.shortName=n.shortName,e.longName=n.longName,e.movesDescription="Moves one square directly forward, and captures one square diagonally forward.",e.specialMoves=["Can move two squares at once if on your second rank.",'If an opposing pawn moves two squares at once, can capture that pawn by "capturing" the square it skipped over.'],e.notes="Upon reaching the final rank, pawns can promote into another piece in the game.",e.categories=["Minor","Pawn"],e.getLegalMoves=function(e,t,n){var c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4?arguments[4]:void 0,o=[];if("captures"!==n&&(1===d.a.getRank(e)||6===d.a.getRank(e)?o.push.apply(o,Object(r.a)(Object(l.a)(t,e,d.a.Pawn*c,[function(e){return c>0?e+8:e-8}],"moves",2).map((function(e){return 16===Math.abs(e.from-e.to)?Object(a.a)(Object(a.a)({},e),{},{special:"DOUBLE"}):e})))):o.push.apply(o,Object(r.a)(Object(l.b)(t,e,d.a.Pawn*c,[function(e){return c>0?e+8:e-8}],"moves")))),"moves"!==n&&(o.push.apply(o,Object(r.a)(Object(l.b)(t,e,d.a.Pawn*c,c>0?[function(t){return 0!==d.a.getFile(e)?t+7:t},function(t){return 7!==d.a.getFile(e)?t+9:t}]:[function(t){return 0!==d.a.getFile(e)?t-9:t},function(t){return 7!==d.a.getFile(e)?t-7:t}],"captures"))),i.length>0&&"DOUBLE"===i[i.length-1].special)){var s=i[i.length-1];s.to===e+1&&7!==d.a.getFile(e)?o.push({from:e,to:c>0?e+9:e-7,special:"EP"}):s.to===e-1&&0!==d.a.getFile(e)&&o.push({from:e,to:c>0?e+7:e-9,special:"EP"})}return o},e}return Object(c.a)(n)}(u.a);g.shortName="P",g.longName="Pawn"},,,,,,,,,function(e,t,n){"use strict";(function(e){var a=n(8),r=n(73),c=n(5),i=n(44),o=n.n(i),s=n(2),u=n(85),l=n(49),d=n(80),f=n(19),g=n(24),h=n(40),b=n(35),v=n(81),j=(n(105),n(69)),p=n(1),m=n(86),O=n(20),y=n(13),x=n(25),N=n(82),w=n(22),k=n(26),C=n(31),T=n(11),S=n(33),M=n(38),D=n(17),E=n(0),P="via Stalemate";t.a=function(){var t=Object(O.h)().uuid,n=Object(s.useState)((function(){var e=localStorage.getItem(y.c)||"{}",n=JSON.parse(e)[t];try{n.army=JSON.parse(n.army),n.opponentArmy=JSON.parse(n.opponentArmy),n.deck=JSON.parse(n.deck),n.opponentDeck=JSON.parse(n.opponentDeck)}catch(a){console.log(a)}return n||{colour:1,opponent:"fiesta"===t?"COMP":"LOCAL",army:"dev-playground"===t?x.c:x.d,opponentArmy:"dev-playground"===t?x.c:x.d,deck:k.b,opponentDecl:k.b}})),i=Object(c.a)(n,1)[0],R=i.colour,B=i.opponent,A=i.army,I=i.opponentArmy,L=i.deck,F=i.opponentDeck,H=Object(s.useRef)(R>0?new l.a(Object(h.a)(A,I),void 0,L,F):new l.a(Object(h.a)(I,A),void 0,F,L)),V=Object(s.useRef)();Object(s.useLayoutEffect)((function(){if("COMP"===B){var t=new Worker(e,{name:"opponent-webworker",type:void 0});V.current=m.a(t),console.log("Creating worker!")}else console.log("Not against a computer opponent");document.body.style.display="none",setTimeout((function(){document.body.style.display="unset"}),0)}),[]);var _=Object(s.useState)(H.current.getBoard()),q=Object(c.a)(_,2),J=q[0],W=q[1],U=Object(s.useState)(H.current.getCurrentTurn()),K=Object(c.a)(U,2),G=K[0],Y=K[1],z=Object(s.useState)(H.current.getMoves()),Q=Object(c.a)(z,2),X=Q[0],Z=Q[1],$=Object(s.useState)(0),ee=Object(c.a)($,2),te=ee[0],ne=ee[1],ae=Object(s.useState)(!1),re=Object(c.a)(ae,2),ce=re[0],ie=re[1],oe=Object(s.useState)(P),se=Object(c.a)(oe,2),ue=se[0],le=se[1];Object(s.useEffect)((function(){ce&&new Audio("/assets/Sounds/8bit-game-over.mp3").play().then()}),[ce]);var de=function(){var e=Object(r.a)(o.a.mark((function e(){var n,r,c,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("fiesta"!==t){e.next=2;break}return e.abrupt("return");case 2:n=V.current.beginBackgroundEvaluation,r=H.current.getMoves(),c=H.current.getBoard(),i=Object(w.a)(r).map((function(e){return{from:e.from,to:e.to,moving:e.moving,captured:e.captured,special:e.special,specify:e.specify}})),n(Object(a.a)(c),i,I.pieces,{colour:-1});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=function(){var e=Object(r.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,V.current.endBackgroundEvaluation)();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ge=function(){var e=Object(r.a)(o.a.mark((function e(){var t,n,r,c,i,s,u,l,d=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:-R,n=V.current.moveGenerator,r=H.current.getMoves(),c=H.current.getBoard(),i=Object(w.a)(r).map((function(e){return{from:e.from,to:e.to,moving:e.moving,captured:e.captured,special:e.special,specify:e.specify}})),s=H.current.getCurrentOngoingEffects().map((function(e){return{square:e.getSquare(),name:e.getName(),target:e.getTarget(),duration:e.getDurationRemaining()}})),u=R>0?H.current.getBlackHand():H.current.getWhiteHand(),l=u.map((function(e){return e.id})),e.next=10,n(Object(a.a)(c),i,I.pieces,t,s,l,{colour:t});case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=Object(s.useContext)(S.b),be=he.Channel,ve=he.Conn;Object(s.useEffect)((function(){if("ONLINE"===B&&be)return be.addEventListener("message",je),function(){be.removeEventListener("message",je)}}),[be,ve]);var je=function(e){var t=JSON.parse(e.data);switch(t.msgType){case"piece_move":console.log("Made a piece move!\n",t.payload);var n=t.payload.move,a=n.from,r=n.to,c=n.special;try{Se(a,r,c,t.payload.additional)}catch(u){console.log(u)}break;case"card_move":console.log("Made a card move!\n",t.payload);var i=t.payload,o=i.id,s=i.targets;try{Ze(o,s,!1)}catch(u){console.log(u)}}},pe=Object(s.useState)([]),me=Object(c.a)(pe,2),Oe=me[0],ye=me[1],xe=Object(s.useState)([]),Ne=Object(c.a)(xe,2),we=Ne[0],ke=Ne[1],Ce=function(e){e>0?ke((function(t){return[].concat(Object(a.a)(t),[e])})):e<0&&ye((function(t){return[].concat(Object(a.a)(t),[e])}))},Te=function(e){var t=H.current.getMoves(),n=H.current.getBoard(),a=H.current.getCurrentOngoingEffects();if(t.length>=12){var r=t.slice(t.length-12,t.length);Object(j.a)(r[0],r[4],r[8])&&Object(j.a)(r[1],r[5],r[9])&&Object(j.a)(r[2],r[6],r[10])&&Object(j.a)(r[3],r[7],r[11])&&(ie(!0),ne(0),le("via Move Repetition"))}if(t.length>=100){var c=t.slice(t.length-100,t.length),i=Object(w.a)(c).filter((function(e){return Math.abs(e.moving)===p.a.Pawn})),o=Object(w.a)(c).filter((function(e){return 0!==e.captured}));0===i.length&&0===o.length&&(ie(!0),ne(0),le("via the Fifty-move rule"))}var s=b.a.getLegalMoves(n,Object(w.a)(t),{colour:-e});0===Object(g.b)(s,n,Object(w.a)(t),-e,a).length&&(ie(!0),Object(g.c)(n,Object(w.a)(t),-e)?(ne(e>0?1:-1),le("via Checkmate")):(ne(0),le(P)))},Se=function e(n,r,c){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=H.current.getBoard()[n]>0?1:-1;o===R&&fe();var s=new Audio("/assets/Sounds/wooden-piece-move.mp3");s.play();var u="EP"===c?H.current.getBoard()[r-8*o]:H.current.getBoard()[r];if(u!==p.a.None&&(console.log("CAPTURING A ".concat(u)),Ce(u)),H.current.Move(n,r,c,i),Te(o),Z(Object(a.a)(H.current.getMoves())),W(Object(a.a)(H.current.getBoard())),"ONLINE"===B&&o===R&&be){var l={move:{from:n,to:r,special:c},additional:i},d=new M.d(l);be.send(JSON.stringify(d))}Ae?(Pe(!0),setTimeout((function(){Y(H.current.getCurrentTurn()),Pe(!1)}),500)):Y(H.current.getCurrentTurn()),setTimeout((function(){ce||H.current.getCurrentTurn()!==-R&&"fiesta"!==t||"COMP"!==B||ge(H.current.getCurrentTurn()).then((function(t){if(!ce&&t)try{t.move?e(t.move.from,t.move.to,t.move.special,t.additional):t.id&&t.targets&&Ze(t.id,t.targets),de()}catch(n){console.log(n),console.log(t)}}))}),0)},Me=Object(s.useState)(!1),De=Object(c.a)(Me,2),Ee=De[0],Pe=De[1],Re=Object(s.useState)(!0),Be=Object(c.a)(Re,2),Ae=Be[0],Ie=Be[1];Object(s.useEffect)((function(){"COMP"===B&&-1===R&&(console.log("Generating opening move"),ge().then((function(e){if(e)try{Se(e.move.from,e.move.to,e.move.special,e.additional),de().then((function(){}))}catch(t){console.log(t),console.log(e)}})))}),[]);var Le=function(){var e=H.current.getLastMove();e&&(H.current.UnMove(),W(Object(a.a)(H.current.getBoard())),Z(Object(a.a)(H.current.getMoves())),Y(H.current.getCurrentTurn()),e instanceof f.a&&(Oe.length>0&&e.captured===Oe[Oe.length-1]?ye((function(e){return e.slice(0,e.length-1)})):we.length>0&&e.captured===we[we.length-1]&&ke((function(e){return e.slice(0,e.length-1)}))))},Fe=Object(s.useState)(null),He=Object(c.a)(Fe,2),Ve=He[0],_e=He[1],qe=Object(s.useState)(0),Je=Object(c.a)(qe,2),We=Je[0],Ue=Je[1],Ke=Object(s.useState)([]),Ge=Object(c.a)(Ke,2),Ye=Ge[0],ze=Ge[1],Qe=function(){console.log("Drag ended, ".concat(We," remaining")),Xe()},Xe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We;console.log("Ending targeting with ".concat(e," remaining")),0===e&&_e(null);var t=document.getElementById("PlayerHand");t&&(t.className="")},Ze=function e(n,a){var r,c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r=Ve?G>0?H.current.getWhiteHand()[Ve||0]:H.current.getBlackHand()[Ve||0]:H.current.getCurrentPlayerHand()[H.current.getCurrentPlayerHand().map((function(e){return e.id})).indexOf(n)],"ONLINE"!==B||c||(r=D.a[n],G>0?H.current.setWhiteHand((function(e){return e.filter((function(e,t){return 0!==t}))})):H.current.setBlackHand((function(e){return e.filter((function(e,t){return 0!==t}))})));H.current.PlayCard(r,a);var i=H.current.getCurrentTurn();if(Te(i),Te(-i),Z(H.current.getMoves()),W(H.current.getBoard()),console.log(B,i,R,be),"ONLINE"===B&&be&&c){var o={id:n,targets:a};console.log("Sending a card message!");var s=new M.a(o);be.send(JSON.stringify(s))}console.log(H.current.getCurrentTurn(),G),setTimeout((function(){console.log(H.current.getCurrentTurn(),G)}),1e3),r.fast||(Ae?(Pe(!0),setTimeout((function(){Y(H.current.getCurrentTurn()),Pe(!1)}),500)):Y(H.current.getCurrentTurn())),setTimeout((function(){ce||H.current.getCurrentTurn()!==-R&&"fiesta"!==t||"COMP"!==B||ge(H.current.getCurrentTurn()).then((function(t){if(!ce&&t)try{t.move?Se(t.move.from,t.move.to,t.move.special,t.additional):t.id&&t.targets&&e(t.id,t.targets),de()}catch(n){console.log(n),console.log(t)}}))}),0)};return Object(E.jsxs)("div",{className:"app paddedTop",children:[Object(E.jsx)("div",{className:"boardLeftColumn"}),Object(E.jsx)("div",{className:"chessBoardColumn ".concat(ce?"gameOver":"playing"),children:Object(E.jsx)(u.a,{board:J,currentTurn:G,move:Se,unMove:Le,moves:X,whiteCaptured:Oe,blackCaptured:we,capturePiece:Ce,whiteArmy:R>0?A.pieces:I.pieces,blackArmy:R<0?A.pieces:I.pieces,playerColour:R,cardTargetingIndex:Ve,game:H.current,opponent:B,gameUUID:t,allowRotation:Ae,setAllowRotation:function(e){return Ie(e)},moveLockout:Ee,playCard:function(e,t){var n=We,a=Ye;We<=0&&null!==Ve&&(n=H.current.getCurrentPlayerHand()[Ve].targets),n--,console.log("APPEND CARD TARGET - ".concat(n," remaining of ").concat(H.current.getCurrentPlayerHand()[Ve||0].targets)),a.push(t),Ue(n),ze(a),0===n&&(Ze(e,a),Xe(n))},cardTargetsRemaining:We,currentTargets:Ye})}),Object(E.jsxs)("div",{className:"boardRightColumn",children:[Object(E.jsxs)("p",{className:"playerToMove",children:[H.current.getCurrentTurn()>0?"White":"Black"," to move"]}),Object(E.jsx)(d.a,{moves:X,unMove:Le,canUndo:"LOCAL"===B})]}),Object(E.jsx)("div",{id:"PlayerHand",children:Object(E.jsx)("div",{id:"PlayerHandInner",children:function(){var e="LOCAL"===B?G>0?H.current.getWhiteHand():H.current.getBlackHand():R>0?H.current.getWhiteHand():H.current.getBlackHand(),n=e.length;return e.map((function(e,a){return Object(E.jsx)(N.a,{draggable:!Ee&&(we.reduce((function(e,t){var n;return e+((null===(n=p.a.getPiece(t))||void 0===n?void 0:n.materialValue)||0)}),0)+Oe.reduce((function(e,t){var n;return e+((null===(n=p.a.getPiece(t))||void 0===n?void 0:n.materialValue)||0)}),0)>=e.cost||"dev-playground"===t)&&!Object(g.c)(J,Object(w.a)(X),G)&&("LOCAL"===B||Object(T.b)(R,G)),card:e,dragStartCallback:function(){return function(e){_e(e),ze([]),console.log("Card drag started on ".concat(e,", card ").concat(H.current.getCurrentPlayerHand()[e].cardName));var t=document.getElementById("PlayerHand");t&&(t.className="forceLower")}(a)},dragEndCallback:Qe,handPosition:a+1,handSize:n})}))}()})}),Object(E.jsx)(C.a,{}),ce?Object(E.jsx)(v.a,{message:ue,winner:te}):null]})}}).call(this,n(94))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n(2);var a=n(19),r=(n(103),n(0));function c(e){var t=e.moves,n=e.unMove,c=e.canUndo;return Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)("div",{id:"BoardMovesDisplay",children:[t.map((function(e,t){return Object(r.jsx)("p",{className:"move",children:Object(r.jsx)("span",{children:e.getMoveName()})},e instanceof a.a?"".concat(e.from).concat(e.to).concat(t):"".concat(e.cardName).concat(t))})),c?Object(r.jsx)("button",{className:"unMakeMove",onClick:n,children:"UnMove!"}):null]})})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(5),r=n(2),c=(n(104),n(0));function i(e){var t=e.winner,n=e.message,i=Object(r.useState)(!1),o=Object(a.a)(i,2),s=o[0],u=o[1];Object(r.useEffect)((function(){setTimeout((function(){return u(!0)}),500)}));return Object(c.jsxs)("div",{id:"GameOverUI",className:"".concat(t<0?"black":"white"," ").concat(s?"shown":"hidden"),children:[Object(c.jsxs)("div",{id:"GameOverHeader",children:[Object(c.jsx)("h2",{className:"scoreMessage",children:function(){switch(t){case 1:return"1-0";case-1:return"0-1";default:return"0.5-0.5"}}()}),Object(c.jsx)("p",{className:"winnerMessage",children:function(){switch(t){case 1:return"White wins";case-1:return"Black wins";default:return"Draw"}}()})]}),Object(c.jsx)("div",{id:"GameOverBody",children:Object(c.jsx)("p",{children:n})}),Object(c.jsx)("button",{onClick:function(){window.location.reload()},children:"Play Again?"})]})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=(n(106),n(0));function c(e){var t=Object(a.useRef)(null),n=Object(a.useRef)(null);return Object(a.useLayoutEffect)((function(){if(n.current){var t=e.handSize%2!==0,a=Math.ceil(e.handSize/2),r=t?a:a+1,c=e.handPosition<=a?a:r,i=5*(e.handPosition-c);0!==i||t||(i+=e.handPosition===a?-2.5:2.5),n.current.style.transform="rotateZ(".concat(i,"deg) translateY(").concat(Math.abs(5*i)-20,"px)")}}),[e.handPosition,e.handSize]),Object(r.jsx)("div",{ref:n,draggable:e.draggable,onDragStart:function(t){return function(t){t.dataTransfer&&(e.dragStartCallback(),t.dataTransfer.setData("text/plain",e.card.id))}(t)},onDragEnd:function(){e.dragEndCallback()},className:"playableCardContainer ".concat(e.draggable?"drag":"noDrag"),children:Object(r.jsxs)("div",{ref:t,className:"playableCard",children:[Object(r.jsxs)("div",{className:"cardChaosScore",children:[Object(r.jsx)("div",{className:"score",children:e.card.cost}),Object(r.jsx)("div",{className:"speed",children:e.card.fast?"Fast":""})]}),Object(r.jsx)("div",{className:"cardTitle",children:e.card.cardName}),Object(r.jsx)("div",{className:"cardDescription",children:e.card.description}),Object(r.jsx)("div",{className:"cardExpac",children:e.card.expac})]})})}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(8),r=n(5),c=n(2),i=(n(96),n(39)),o=n(1),s=n(0);function u(e){var t=e.position,n=e.highlight,a=e.rotated,r=e.moveCircle,c=void 0!==r&&r,u=e.border,l=void 0!==u&&u;return Object(s.jsxs)("div",{style:o.a.getStyle(t,a),className:"chessSquare ".concat((7*o.a.getRank(t)+o.a.getFile(t))%2===1?"light":"dark"," ").concat(c?"moveCircle":""," ").concat(l?"border":""),id:"square-".concat(o.a.getSquareName(t)),children:[function(){var e=[];return 0===o.a.getRank(t)&&e.push(Object(s.jsx)("span",{className:"sqLabel bottom",children:i.a[o.a.getFile(t)]},"file")),0===o.a.getFile(t)&&e.push(Object(s.jsx)("span",{className:"sqLabel left",children:o.a.getRank(t)+1},"rank")),e}(),n?Object(s.jsx)("div",{className:"highlight"}):null]},"square-".concat(o.a.getSquareName(t)))}n(98),n(99);function l(e){var t=e.position,n=e.piece,a=e.target,r=e.unTarget,i=e.onHover,u=e.onUnHover,l=e.active,d=e.id,f=e.draggable,g=e.rotated,h=e.onRightClick,b=Object(c.useRef)(t),v=Object(c.useRef)(null),j=Object(c.useRef)(null);Object(c.useLayoutEffect)((function(){if(v.current){var e=v.current,n=o.a.getFile(t)-o.a.getFile(b.current),a=o.a.getRank(t)-o.a.getRank(b.current);g&&(n=-n,a=-a),e.style.transition="none",e.style.transform="translate(".concat(100*-n,"%, ").concat(100*a,"%)"),setTimeout((function(){e.style.transition="transform 0.25s ease",e.style.transform="translate(0, 0)"}),0)}b.current=t}),[t]),Object(c.useLayoutEffect)((function(){j.current&&(l||(j.current.style.transform=""))}),[l]);var p=function(e){2===e.button&&(e.preventDefault(),h(d)),0===e.button&&f&&(a("piece-click"),j.current&&(j.current.style.transform="translateY(.25rem) scale(0.95)"))};return Object(s.jsx)("div",{className:"piece ".concat(l?"active":""," ").concat(n>0?"white":"black"),ref:v,id:d,style:o.a.getStyle(t,g),draggable:f,onDragStart:f?function(e){j.current&&(j.current.style.transform=""),e.dataTransfer&&(a("piece-drag"),e.dataTransfer.setData("text/plain",JSON.stringify([n,t])),e.dataTransfer.effectAllowed="move")}:function(){return!1},onDragEnd:function(){return r("piece-drag")},onMouseEnter:i,onMouseLeave:u,onMouseDown:function(e){return p(e)},onContextMenu:function(e){return p(e)},children:Object(s.jsx)("img",{ref:j,src:o.a.getImage(n),alt:n.toString(),className:"pieceImg"})},d)}n(100);function d(e){var t=e.position,n=e.onDrop,a=e.isMove,r=e.onClick,c=e.isCapture,i=e.rotated;return Object(s.jsx)("div",{style:o.a.getStyle(t,i),className:"targetingSquare ".concat(a?"move":""," ").concat(c?"capture":""),id:"target_".concat(o.a.getSquareName(t)),onDrop:n,onMouseDown:function(e){e.stopPropagation(),r()},onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}})}n(101);function f(e){var t=e.captures,n=e.evaluation;return Object(s.jsxs)("div",{className:"infoBar",children:[Object(s.jsx)("p",{className:"materialEval",children:0!==n?"("+(n>=0?"+":"")+n+")":""}),t.map((function(e,t){var n,a,r,c;return Object(s.jsx)("div",{className:"capturedPiece",children:Object(s.jsx)("img",{title:"".concat(null===(a=o.a.getPiece(e))||void 0===a?void 0:a.longName," (").concat(null===(r=o.a.getPiece(e))||void 0===r?void 0:r.materialValue,")"),src:o.a.getImage(e),alt:(null===(c=o.a.getPiece(e))||void 0===c?void 0:c.shortName)||"unknown piece"})},((null===(n=o.a.getPiece(e))||void 0===n?void 0:n.longName)||"Piece")+"".concat(t))}))]})}var g=n(24),h=(n(35),function(e){return e.filter((function(e){return e!==o.a.None})).reduce((function(e,t){return null===o.a.getPiece(t)?e:t>0?e+o.a.getPiece(t).materialValue:t<0?e-o.a.getPiece(t).materialValue:e}),0)}),b=n(19);n(102);function v(e){var t=e.above,n=e.positionFrom,a=e.positionTo,r=e.validPieces,c=e.promoting,i=e.callback,u=e.rotated,l=function(){var e=Math.max(Math.min(o.a.getFile(a)-r.length/2,8-r.length),0);return Object.assign({width:"".concat(12.5*r.length,"%")},u?{left:"".concat(12.5*(8-e-r.length),"%"),top:"".concat(12.5*(o.a.getRank(a)+(t?-1:1)),"%"),borderBottomLeftRadius:t&&e+r.length===o.a.getFile(a)+1?"0":"1rem",borderBottomRightRadius:t&&0===o.a.getFile(a)?"0":"1rem",borderTopLeftRadius:t||e+r.length!==o.a.getFile(a)+1?"1rem":"0",borderTopRightRadius:t||0!==o.a.getFile(a)?"1rem":"0"}:{left:"".concat(12.5*e,"%"),top:"".concat(12.5*(7-o.a.getRank(a)+(t?1:-1)),"%"),borderTopRightRadius:t&&e+r.length===o.a.getFile(a)+1?"0":"1rem",borderTopLeftRadius:t&&0===o.a.getFile(a)?"0":"1rem",borderBottomRightRadius:t||e+r.length!==o.a.getFile(a)+1?"1rem":"0",borderBottomLeftRadius:t||0!==o.a.getFile(a)?"1rem":"0"})},d=function(){return Object(s.jsx)("div",{id:"PiecePromotionHead",style:u?{left:"".concat(12.5*(7-o.a.getFile(a)),"%"),top:"".concat(12.5*o.a.getRank(a),"%"),borderRadius:t?"0 0 1rem 1rem":"1rem 1rem 0 0"}:{left:"".concat(12.5*o.a.getFile(a),"%"),top:"".concat(12.5*(7-o.a.getRank(a)),"%"),borderRadius:t?"1rem 1rem 0 0":"0 0 1rem 1rem"},children:Object(s.jsx)("img",{src:o.a.getImage(c),alt:""})})},f=function(){return Object(s.jsx)("div",{id:"PiecePromotionBody",style:l(),children:r.map((function(e){return Object(s.jsx)("div",{className:"promotionPiece",style:{width:"".concat(100/r.length,"%")},onMouseDown:function(){return i(c,e,n,a)},children:Object(s.jsx)("img",{src:o.a.getImage(e),alt:""})})}))})};return u?t?Object(s.jsxs)(s.Fragment,{children:[" ",f()," ",d()]}):Object(s.jsxs)(s.Fragment,{children:[" ",d()," ",f()," "]}):t?Object(s.jsxs)(s.Fragment,{children:[" ",d()," ",f()]}):Object(s.jsxs)(s.Fragment,{children:[" ",f()," ",d()," "]})}var j=n(40),p=n(22),m=n(17);function O(e){var t=e.board,n=e.currentTurn,i=e.game,O=e.move,y=(e.unMove,e.moves),x=e.whiteCaptured,N=e.blackCaptured,w=e.capturePiece,k=e.whiteArmy,C=e.blackArmy,T=e.playerColour,S=e.opponent,M=e.gameUUID,D=e.moveLockout,E=e.allowRotation,P=e.setAllowRotation,R=e.cardTargetingIndex,B=e.playCard,A=e.cardTargetsRemaining,I=e.currentTargets,L=(-1===T&&"LOCAL"!==S||-1===n&&"LOCAL"===S)&&"dev-playground"!==M&&E,F=Object(c.useState)("dev-playground"===M),H=Object(r.a)(F,1)[0],V=function(e,n,a,r){if(Math.abs(e)!==o.a.Pawn||o.a.getRank(a)!==(e>0?7:0)){"EP"===r?t[a-8]:t[a];O(n,a,r),U([0,0])}else{ie([n,a]);var c="EP"===r?t[a-8]:t[a];c!==o.a.None&&w(c)}},_=function(e,t){var n=t,r=1;if(y.length>0){var c=Object(a.a)(y).reverse(),i=!1;n=c.reduce((function(t,n,a){return i?t:(r=c.length-a,n instanceof b.a?(n.to===t&&"PROMOTION"===n.special&&n.additional.promotionTo===e&&(i=!0),n.to!==t||n.moving!==e||i?t:n.from):m.a[n.cardName].trackPiece(t,n.targets))}),t),Math.abs(e)!==o.a.Rook&&Math.abs(e)!==o.a.Bede||(n=c.reduce((function(t,n,a){if(n instanceof b.a){var r=n.to===t&&n.moving===e,c="CASTLE"===n.special&&(n.to===t+1||n.to===t-1);return r?n.from:c&&Math.abs(e)===o.a.Bede?n.to===t+1?n.to+1:n.to-1:c?n.to===t+1?n.to+1:n.to-2:t}return t}),t))}return"".concat(n,"-").concat(e,"-").concat(r)},q=Object(c.useState)([0,-1]),J=Object(r.a)(q,2),W=J[0],U=J[1],K=Object(c.useState)("piece-click"),G=Object(r.a)(K,2),Y=G[0],z=G[1],Q=function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){U(e),z(t)}));Object(c.useLayoutEffect)((function(){null!==R&&z("card-drag")}),[R]);var X=Object(c.useState)(-1),Z=Object(r.a)(X,2),$=Z[0],ee=Z[1],te=Object(c.useState)([-1,-1]),ne=Object(r.a)(te,2),ae=Object(r.a)(ne[0],2),re=ae[0],ce=ae[1],ie=ne[1],oe=Object(c.useState)(-1),se=Object(r.a)(oe,2),ue=se[0],le=se[1],de=Object(c.useState)(""),fe=Object(r.a)(de,2),ge=fe[0],he=fe[1],be=function(e,t){le(e),he(t),window.addEventListener("click",ve),window.addEventListener("dragstart",ve)},ve=function e(t){var n=document.getElementById("PieceInfoBubble");if(n){var a=n.getBoundingClientRect(),r=a.x,c=a.y,i=a.width,o=a.height;(t.pageX<r||t.pageX>r+i||t.pageY<c||t.pageY>c+o)&&(le(-1),window.removeEventListener("click",e))}};Object(c.useLayoutEffect)((function(){var e=document.getElementById(ge),t=document.getElementById("PieceInfoBubble");if(t&&e){var n=e.getBoundingClientRect(),a=n.x,r=n.y,c=n.height,i=n.width,o=t.getBoundingClientRect(),s=o.height,u=o.width,l=window.window.visualViewport.height-s/2,d=r+c/2-s/2,f=Math.min(l,Math.max(10,d));t.style.top="".concat(f,"px");var g=a+20<window.innerWidth/2,h=window.innerHeight-u/2,b=g?a-u-10:window.visualViewport.width-a-i-u-10,v=Math.min(h,Math.max(0,b));g?(t.style.left="".concat(v,"px"),t.style.right=""):(t.style.right="".concat(v,"px"),t.style.left="")}}),[ge,ue]);var je=Object(c.useState)("white"),pe=Object(r.a)(je,2),me=pe[0],Oe=pe[1],ye=Object(c.useState)(!1),xe=Object(r.a)(ye,2),Ne=xe[0],we=xe[1],ke=function(e,t){return e.cards.filter((function(e){return e===t})).length};return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(f,{captures:L?x:N,evaluation:-h(t)*(L?-1:1)}),Object(s.jsxs)("div",{id:"ChessBoardWrapper",children:[Object(s.jsxs)("div",{id:"ChessBoardOuter",children:[Object(s.jsx)("div",{id:"ChessBoardSquares",className:"board",children:t.map((function(e,t){var n=y.filter((function(e){return e instanceof b.a})),r=i.getCurrentOngoingEffects().reduce((function(e,t){return-1===e.indexOf(t.getSquare())?[].concat(Object(a.a)(e),[t.getSquare()]):e}),[]);return Object(s.jsx)(u,{position:t,rotated:L,moveCircle:!1,border:-1!==r.indexOf(t),highlight:n.length>=1&&(t===n[n.length-1].to||t===n[n.length-1].from)})}))}),0!==W[0]||null!==R?Object(s.jsx)("div",{id:"ChessBoardTargeting",className:"board",onMouseDown:function(){return Q([0,-1],Y)},children:function(){if(null===R)return o.a.getPiece(W[0])?Object(g.b)(o.a.getPiece(W[0]).getLegalMoves(W[1],t,"all",W[0]>0?1:-1,y.filter((function(e){return e instanceof b.a}))),t,y.filter((function(e){return e instanceof b.a})),W[0]>0?1:-1,i.getCurrentOngoingEffects()).map((function(e){return Object(s.jsx)(d,{position:e.to,isCapture:t[e.to]!==o.a.None||"EP"===e.special,isMove:t[e.to]===o.a.None,onClick:function(){return V(W[0],e.from,e.to,e.special)},onDrop:function(t){return function(e,t,n){var a=JSON.parse(e.dataTransfer.getData("text/plain")),c=Object(r.a)(a,2),i=c[0],o=c[1];V(i,o,t,n)}(t,e.to,e.special)},rotated:L})})):null;var e=i.getCurrentPlayerHand()[R],c=0===A?0:e.targets-A,u=e.getValidTargets[c];return(u=u||e.getValidTargets[0])?u(t,n,Object(p.a)(y),I,i.getCurrentOngoingEffects()).filter((function(t){return Object(g.a)(i,e.id,[].concat(Object(a.a)(I),[t]),n)})).map((function(e){return Object(s.jsx)(d,{position:e,isCapture:!1,isMove:!0,onClick:function(){return function(e){if(null!==R){var t=i.getCurrentPlayerHand()[R];B(t.id,e)}}(e)},onDrop:function(t){return function(e,t){if(e.dataTransfer){var n=e.dataTransfer.getData("text/plain");B(n,t)}}(t,e)},rotated:L})})):null}()}):null,Object(s.jsx)("div",{id:"ChessBoardPieces",className:"board ".concat(0!==W[0]?"targeting ".concat(Y," ").concat(W[0]>0?"whitemove":"blackmove"):""," ").concat(null===R?"":"card-targeting"),children:t.map((function(e,t){return 0===e?null:Object(s.jsx)(l,{position:t,piece:e,id:_(e,t),draggable:(n>0&&e>0&&(T>0||"LOCAL"===S)||n<0&&e<0&&(T<0||"LOCAL"===S))&&!D||H,clickable:(n>0&&e>0&&(T>0||"LOCAL"===S)||n<0&&e<0&&(T<0||"LOCAL"===S))&&!D||H,target:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(n){return Q([e,t],n)})),unTarget:function(e){return Q([0,-1],e)},onHover:function(){return ee(t)},onUnHover:function(){return ee(-1)},onRightClick:function(e){return be(t,e)},active:W[1]===t||-1===W[1],rotated:L},_(e,t))}))}),Object(s.jsx)("div",{id:"ChessBoardMoveCircles",className:"board",children:function(){var e,n=[],r=-1===$?[]:null===(e=o.a.getPiece(t[$]))||void 0===e?void 0:e.getLegalMoves($,Object(j.b)(),"all",t[$]>0?1:-1,y.filter((function(e){return e instanceof b.a}))).filter((function(e){return e.to!==e.from})).map((function(e){return Object(s.jsx)(u,{position:e.to,rotated:L,moveCircle:!0,highlight:!1})}));return r&&n.push.apply(n,Object(a.a)(r)),$!==W[1]&&o.a.getPiece(W[0])&&n.push.apply(n,Object(a.a)(Object(g.b)(o.a.getPiece(W[0]).getLegalMoves(W[1],t,"all",W[0]>0?1:-1,y.filter((function(e){return e instanceof b.a}))),t,y.filter((function(e){return e instanceof b.a})),W[0]>0?1:-1,i.getCurrentOngoingEffects()).map((function(e){return Object(s.jsx)(u,{position:e.to,rotated:L,moveCircle:!0,highlight:!1})})))),n}()}),-1!==re?Object(s.jsx)(v,{above:7===o.a.getRank(ce),positionFrom:re,positionTo:ce,validPieces:function(e){var t=e>0?k:C;return console.log(e),t.filter((function(e){return Math.abs(e)!==o.a.King})).reduce((function(e,t){return-1===e.indexOf(t)?[].concat(Object(a.a)(e),[t]):e}),[]).filter((function(e){return Math.abs(e)!==o.a.King})).sort((function(e,t){return e-t})).map((function(t){return e>0?t:-t}))}(t[re]>0?1:-1),promoting:re>0?t[re]:o.a.None,callback:function(e,t,n,a){O(n,a,"PROMOTION",{promotionTo:t}),ie([-1,-1])},rotated:L}):null]}),Object(s.jsxs)("div",{id:"ChaosValue",title:"Chaos Value - the material value of all pieces captured. Must meet a threshold before cards can be played.",children:[Object(s.jsx)("div",{className:"val",id:"ChaosValueScore",children:i.getChaosScore()}),Object(s.jsx)("div",{className:"sub",children:"CHAOS VALUE"})]}),Object(s.jsxs)("div",{id:"BlackDeck",title:"Click to see cards",className:"deck",onClick:function(){Oe(L?"white":"black"),we(!0)},children:[Object(s.jsxs)("p",{children:[L?"White":"Black"," Deck"]}),Object(s.jsxs)("p",{children:[(L?i.getWhiteCurrentDeck():i.getBlackCurrentDeck()).length," card/s remaining"]})]}),Object(s.jsxs)("div",{id:"WhiteDeck",title:"Click to see cards",className:"deck",onClick:function(){Oe(L?"black":"white"),we(!0)},children:[Object(s.jsxs)("p",{children:[L?"Black":"White"," Deck"]}),Object(s.jsxs)("p",{children:[(L?i.getBlackCurrentDeck():i.getWhiteCurrentDeck()).length," card/s remaining "]})]}),Object(s.jsx)("div",{id:"HandNotice",children:Object(s.jsxs)("p",{className:"hand",children:["Opponent has ",L?i.getWhiteHand().length:i.getBlackHand().length," card/s in hand"]})}),function(){var e="white"===me?i.getWhiteDeck():i.getBlackDeck();return Object(s.jsxs)("div",{id:"DeckOverlay",className:Ne?"shown":"hidden",children:[Object(s.jsx)("div",{className:"close",onClick:function(){return we(!1)},children:"x"}),Object(a.a)(e.cards).filter((function(e,t,n){return n.indexOf(e)===t})).map((function(e){return m.a[e]})).map((function(t){return Object(s.jsxs)("div",{className:"deckOverlayCard",children:[Object(s.jsxs)("div",{className:"topRow",children:[Object(s.jsx)("p",{className:"chaosCost",children:t.cost}),Object(s.jsx)("p",{className:"speed",children:t.fast?"fast":""})]}),Object(s.jsx)("p",{className:"title",children:t.cardName}),Object(s.jsx)("p",{className:"desc",children:t.description}),Object(s.jsx)("p",{className:"expac",children:t.expac}),Object(s.jsxs)("p",{className:"quantity",children:["x",ke(e,t.id)]})]})}))]})}()]}),Object(s.jsx)(f,{captures:L?N:x,evaluation:h(t)*(L?-1:1)}),function(){if(-1===ue)return null;var e=t[ue],n=o.a.getPiece(e);if(!n)return null;return Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("div",{id:"PieceInfoBubble",style:{position:"absolute"},children:[Object(s.jsx)("div",{onContextMenu:function(e){return e.preventDefault()},onMouseDown:function(){return le(-1)},className:"exit",children:"\u2716"}),Object(s.jsx)("h3",{id:"PieceInfoPieceTitle",children:n.longName}),Object(s.jsx)("div",{className:"imgRow",children:Object(s.jsx)("img",{src:o.a.getImage(e)})}),Object(s.jsx)("div",{className:"pieceDescBlock moves",children:n.movesDescription}),Object(s.jsx)("div",{className:"pieceDescBlock moves",children:n.specialMoves.map((function(e,t){return Object(s.jsx)("div",{className:"move",children:e})}))}),Object(s.jsx)("div",{className:"pieceDescBlock notes",children:n.notes}),Object(s.jsx)("div",{className:"pieceDescBlock effects",children:i.getCurrentOngoingEffects().filter((function(e){return e.getSquare()===ue})).map((function(e,t){return Object(s.jsxs)("p",{children:[e.getToolTip()," ",e.getDurationRemaining()," turn",1===e.getDurationRemaining()?"":"s"," remaining."]})}))}),Object(s.jsxs)("div",{className:"pieceDescBlock tags",children:["Tags: ",n.categories.map((function(e,t){return Object(s.jsxs)("span",{className:"tag",children:[e,t!==n.categories.length-1?", ":""]})}))]})]})})}(),Object(s.jsxs)("div",{className:"allowRotationCheckbox",children:[Object(s.jsx)("input",{type:"checkbox",checked:E,onChange:function(e){return P(e.target.checked)}}),Object(s.jsx)("label",{children:"Allow rotation?"})]})]})}},,,,,,,,function(e,t,n){},function(e,t,n){e.exports=n.p+"static/js/opponent-webworker.88927c66.chunk.worker.js"},,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),c=n(78),i=n.n(c),o=(n(93),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,126)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))}),s=n(5),u=n(20),l=n(79),d=n(12),f=n(8),g=n(31),h=n(25),b=(n(119),n(18)),v=n(87),j=n(32),p=n(13),m=n(1),O=n(28),y=n(26),x=n(33),N=n(38),w=n(0);function k(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)([]),i=Object(s.a)(c,2),o=i[0],l=i[1],k=Object(a.useState)([]),D=Object(s.a)(k,2),E=D[0],P=D[1];Object(a.useLayoutEffect)((function(){!function(){var e=localStorage.getItem(p.a),t=[];if(t.push(h.d,h.b),e){var n=JSON.parse(e);t.push.apply(t,Object(f.a)(Object.values(n)))}r(t)}(),function(){var e=localStorage.getItem(p.b),t=[];if(t.push(y.d,y.a),e){var n=JSON.parse(e);t.push.apply(t,Object(f.a)(Object.values(n)))}l(t)}(),function(){var e=localStorage.getItem(p.c),t=[];if(e){var n=JSON.parse(e);t.push.apply(t,Object(f.a)(Object.values(n)))}P(t)}()}),[]);var R=Object(a.useState)("LOCAL"),B=Object(s.a)(R,2),A=B[0],I=B[1],L=Object(a.useState)("WHITE"),F=Object(s.a)(L,2),H=F[0],V=F[1],_=Object(a.useState)(0),q=Object(s.a)(_,2),J=q[0],W=q[1],U=Object(a.useState)(0),K=Object(s.a)(U,2),G=K[0],Y=K[1],z=Object(a.useState)(0),Q=Object(s.a)(z,2),X=Q[0],Z=Q[1],$=Object(a.useState)(0),ee=Object(s.a)($,2),te=ee[0],ne=ee[1],ae=function(e){return e.filter((function(e){return 6!==e})).reduce((function(e,t){var n;return((null===(n=m.a.getPiece(t))||void 0===n?void 0:n.materialValue)||0)+e}),0)},re=Object(a.useState)(!1),ce=Object(s.a)(re,2),ie=ce[0],oe=ce[1],se=function(e){var t,n=JSON.parse(e.army),a=JSON.parse(e.opponentArmy),r=(t={},Object(d.a)(t,"ONLINE","Online Opponent"),Object(d.a)(t,"LOCAL","Local Opponent"),Object(d.a)(t,"COMP","Computer Opponent"),t)[e.opponent];return Object(w.jsx)(O.b,{to:"/play/game/".concat(e.uuid),children:Object(w.jsxs)("div",{title:"Game ".concat(e.uuid),className:"existingGame",children:[Object(w.jsxs)("p",{children:[e.colour>0?n.name:a.name,","]}),Object(w.jsx)("p",{children:e.colour<0?n.name:a.name}),Object(w.jsxs)("p",{children:["vs ",r]})]})})},ue=Object(a.useContext)(x.b),le=ue.Conn,de=ue.Channel,fe=(ue.setListener,ue.initChannel,Object(a.useState)(!1)),ge=Object(s.a)(fe,2),he=ge[0],be=ge[1],ve=Object(a.useState)(!1),je=Object(s.a)(ve,2),pe=je[0],me=je[1],Oe=Object(u.f)();Object(a.useEffect)((function(){"ONLINE"===A&&de?(console.log("Adding event listener to channel ".concat(de.id)),de.addEventListener("message",ye)):"ONLINE"===A&&console.log("Online, but Channel not currently defined: \n",de)}),[A,de]);var ye=function(e){var t=JSON.parse(e.data);switch(console.log(t),t.msgType){case"setup_choice":switch(console.log("received a setup choice"),t.payload.data){case"WHITE":V("BLACK");break;case"BLACK":V("WHITE");break;default:V("RANDOM")}break;case"ready":console.log("Your opponent has signalled they are ready!"),be(!0);break;case"game_start_request":console.log("Your opponent has sent a request to start the game"),function(e){if(de){var t=Object(v.a)(),a=1,r=n[0],c=o[0];V((function(e){return a="RANDOM"===e?Object(j.a)([-1,1]):["BLACK","","WHITE"].indexOf(e)-1,e})),W((function(e){return r=-1===e?Object(j.a)(n):n[e],e})),Z((function(e){return c=-1===e?Object(j.a)(o):o[e],e}));var i=e.payload.army,s=e.payload.deck,u={uuid:t,opponent:A,colour:a,army:JSON.stringify(r),opponentArmy:JSON.stringify(i),deck:JSON.stringify(c),opponentDeck:JSON.stringify(s)},l=new N.c(u);de.send(JSON.stringify(l));var d=localStorage.getItem(p.c)||"{}",f=JSON.parse(d);f[t]=u,localStorage.setItem(p.c,JSON.stringify(f)),console.log("Loading into game with the following game data \n",u),Oe.push("/play/game/".concat(t))}else console.warn("TRIED TO LOAD INTO GAME, BUT NO DATA CHANNEL!")}(t);break;case"game_start_response":console.log("Response received from opponent - game ready to start"),function(e){var t=e.payload,n=Object(v.a)(),a={uuid:n,opponent:t.opponent,army:t.opponentArmy,opponentArmy:t.army,deck:t.opponentDeck,opponentDeck:t.deck,colour:-1===t.colour?1:-1},r=localStorage.getItem(p.c)||"{}",c=JSON.parse(r);c[n]=a,localStorage.setItem(p.c,JSON.stringify(c)),console.log("Received the following game data\n",t),console.log("Loading into game with the following game data\n",a),Oe.push("/play/game/".concat(n))}(t)}},xe=function(e){if(V(e),"ONLINE"===A&&de){var t=e,n=new N.f({choice:"colour",data:t});console.log("Sending a message via channel ".concat(de.id,"!")),de.send(JSON.stringify(n))}};return Object(w.jsxs)("div",{id:"PlayPage",className:"paddedTop",children:[Object(w.jsx)(g.a,{}),Object(w.jsx)("h1",{children:"Setup your game!"}),Object(w.jsxs)("p",{onClick:function(){return oe((function(e){return!e}))},className:"toggleExistingGames",children:[ie?"Hide":"Show"," current games"]}),Object(w.jsx)("div",{className:"existingGames",children:ie?E.map(se):null}),Object(w.jsxs)("div",{className:"playPageInner",children:[Object(w.jsx)("h3",{children:"Who do you want to face?"}),Object(w.jsx)(M,{item:"LOCAL OPPONENT",selected:"LOCAL"===A,onPress:function(){return I("LOCAL")},disabled:pe}),Object(w.jsx)(M,{item:"COMPUTER OPPONENT",selected:"COMP"===A,onPress:function(){return I("COMP")},disabled:pe}),Object(w.jsx)(M,{item:"ONLINE",selected:"ONLINE"===A,onPress:function(){return I("ONLINE")},disabled:"connected"!==le.connectionState||pe,toolTip:S}),Object(w.jsx)("h3",{children:"Which colour do you want to play as?"}),Object(w.jsx)(M,{item:"WHITE",selected:"WHITE"===H,onPress:xe,disabled:pe}),Object(w.jsx)(M,{item:"BLACK",selected:"BLACK"===H,onPress:xe,disabled:pe}),Object(w.jsx)(M,{item:"RANDOM",selected:"RANDOM"===H,onPress:xe,disabled:pe}),Object(w.jsx)("h3",{children:"Which army do you want to use?"}),n.map((function(e,t){return Object(w.jsx)(M,{item:e.name.toUpperCase(),selected:J===t,onPress:function(){return W(t)},disabled:ae(e.pieces)>31||pe,toolTip:C})})),Object(w.jsx)(M,{item:"RANDOM",selected:-1===J,onPress:function(){return W(-1)},disabled:pe}),"ONLINE"===A?null:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h3",{children:"Which army do you want your opponent to use?"}),n.map((function(e,t){return Object(w.jsx)(M,{item:e.name.toUpperCase(),selected:G===t,onPress:function(){return Y(t)},disabled:ae(e.pieces)>31,toolTip:C})})),Object(w.jsx)(M,{item:"RANDOM",selected:-1===G,onPress:function(){return Y(-1)}})]}),Object(w.jsx)("h3",{children:"Which deck do you want to use?"}),o.map((function(e,t){return Object(w.jsx)(M,{item:e.name.toUpperCase(),selected:X===t,onPress:function(){return Z(t)},disabled:15!==e.cards.length||pe,toolTip:T})})),Object(w.jsx)(M,{item:"RANDOM",selected:-1===X,onPress:function(){return Z(-1)},disabled:pe}),"ONLINE"===A?null:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h3",{children:"Which deck do you want your opponent to use?"}),o.map((function(e,t){return Object(w.jsx)(M,{item:e.name.toUpperCase(),selected:te===t,onPress:function(){return ne(t)},disabled:15!==e.cards.length,toolTip:T})})),Object(w.jsx)(M,{item:"RANDOM",selected:-1===te,onPress:function(){return ne(-1)}})]}),Object(w.jsx)("div",{className:"centred",children:"ONLINE"!==A?Object(w.jsx)(b.a,{onClick:function(){return function(){var e=Object(v.a)(),t="RANDOM"===H?Object(j.a)([-1,1]):["BLACK","","WHITE"].indexOf(H)-1,a=-1===J?Object(j.a)(n):n[J],r=-1===G?Object(j.a)(n):n[G],c=-1===X?Object(j.a)(o):o[X],i=-1===te?Object(j.a)(o):o[te],s={uuid:e,opponent:A,colour:t,army:JSON.stringify(a),opponentArmy:JSON.stringify(r),deck:JSON.stringify(c),opponentDeck:JSON.stringify(i)},u=localStorage.getItem(p.c)||"{}",l=JSON.parse(u);l[e]=s,localStorage.setItem(p.c,JSON.stringify(l)),window.location.href="/play/game/".concat(e)}()},text:"START GAME",buttonStyle:"medium"}):Object(w.jsx)(b.a,{onClick:function(){return function(){if(de)if(me(!0),he){var e={army:n[J],deck:o[X]},t=new N.b(e);de.send(JSON.stringify(t))}else{var a=new N.e;de.send(JSON.stringify(a))}else console.warn("Tried to ready, but not connected!")}()},text:pe?he?"Getting into game...":"Waiting for opponent":"I'm Ready!",buttonStyle:"medium",disabled:pe})})]})]})}var C="Army too strong - edit it to play with it.",T="Your deck has the incorrect number of cards - edit it to play with it.",S="You must be connected to another player to play online.";function M(e){var t=e.selected,n=e.item,a=e.onPress,r=e.itemToString,c=void 0===r?function(e){return e}:r,i=e.toolTip,o=e.disabled,s=void 0!==o&&o;return Object(w.jsx)("div",{title:s?i:"",className:"selectionItem ".concat(t?"selected":""," ").concat(s?"disabled":""),onClick:s?function(){}:function(){return a(n)},children:c(n)})}function D(){var e=Object(u.i)().url;return Object(w.jsxs)(u.c,{children:[Object(w.jsx)(u.a,{path:"".concat(e),exact:!0,children:Object(w.jsx)(k,{})}),Object(w.jsx)(u.a,{path:"".concat(e,"/game/:uuid"),children:Object(w.jsx)(l.a,{})})]})}n(120);function E(){var e=function(e){var t=localStorage.getItem(p.a);if(t){var n=JSON.parse(t);n[e]&&delete n[e],localStorage.setItem(p.a,JSON.stringify(n)),window.location.reload()}};return Object(w.jsxs)("div",{id:"ArmiesPage",className:"paddedTop",children:[Object(w.jsx)(g.a,{}),Object(w.jsx)("h1",{className:"pageHeading",children:"Your Armies"}),Object(w.jsx)("p",{className:"pageSubtitle",children:"Where you can view, edit, create and delete armies."}),Object(w.jsx)("p",{className:"pageSubtitle",children:"Click on an army to edit it, hover over an army to delete it."}),Object(w.jsx)("div",{className:"armiesButtonRow",children:Object(w.jsx)(b.a,{onClick:function(){return function(){var e=localStorage.getItem(p.a),t="";if(e){var n=JSON.parse(e);for(t=prompt("Enter a name for your army","My Army")||"My Army";n[t];)t=prompt("That name has already been chosen")||"My Army";var a=Object.assign(Object(d.a)({},t,new h.a(h.d.pieces,t)),n);localStorage.setItem(p.a,JSON.stringify(a))}else{t=prompt("Enter a name for your army","My Army")||"My Army";var r=Object(d.a)({},t,new h.a(h.d.pieces,t));localStorage.setItem(p.a,JSON.stringify(r))}window.location.href="/armies/".concat(t)}()},text:"NEW ARMY",buttonStyle:"small"})}),Object(w.jsx)("div",{className:"armiesListing",children:function(){var e=[],t=localStorage.getItem(p.a);if(t){var n=JSON.parse(t);Object.keys(n).map((function(t){return e.push(n[t])}))}return e}().map((function(t){return Object(w.jsx)(P,{army:t,deleteArmy:e})}))})]})}function P(e){var t=e.army,n=e.deleteArmy;return Object(w.jsxs)("div",{className:"armyPreview",onClick:function(){return window.location.href="/armies/".concat(t.name)},children:[Object(w.jsx)("div",{className:"delete",onClick:function(e){e.stopPropagation(),n(t.name)},children:"\u2716"}),Object(w.jsx)("h3",{className:"ArmyName",children:t.name}),Object(w.jsx)("div",{className:"pieces",children:t.pieces.map((function(e){var t;return Object(w.jsx)("p",{children:(null===(t=m.a.getPiece(e))||void 0===t?void 0:t.longName)||"name error"})}))})]})}n(121);function R(){var e,t,n,r,c,i,o,l,d=Object(u.h)().armyID,v=Object(a.useState)(""),j=Object(s.a)(v,2),O=j[0],y=j[1],x=Object(a.useState)([1,1,1,1,1,1,1,1]),N=Object(s.a)(x,2),k=N[0],C=N[1],T=Object(a.useState)(!1),S=Object(s.a)(T,2),M=S[0],D=S[1];Object(a.useLayoutEffect)((function(){var e=localStorage.getItem(p.a);if(e){var t=JSON.parse(e);y(t[d].name),C(t[d].pieces)}else alert("No army detected. Redirecting to army menu."),window.location.href="./armies"}),[]);var E=Object(a.useState)(0),P=Object(s.a)(E,2),R=P[0],B=P[1],A=function(e,t,n){if(e.dataTransfer){var a="".concat(t);void 0!==n&&(a+="-".concat(n)),e.dataTransfer.setData("text",a),e.dataTransfer.effectAllowed="move"}},I=function(e,t){var n=document.getElementById("ArmyChessBoard");if(n&&Math.abs(k[t])!==m.a.King){var a=n.getBoundingClientRect(),r=a.top,c=a.height,i=a.left,o=a.width,s=e.clientX,u=e.clientY;if(u<r||u>r+c||s<i||s>i+o){var l=Object(f.a)(k).map((function(e,n){return n===t?m.a.None:e}));C(l),D(!0),L.current&&(L.current.className="",l.filter((function(e){return 6!==e})).reduce((function(e,t){var n;return((null===(n=m.a.getPiece(t))||void 0===n?void 0:n.materialValue)||0)+e}),0)>31&&setTimeout((function(){L.current&&(L.current.className="invalid")}),0))}}},L=Object(a.useRef)(null),F=function(){return k.filter((function(e){return 6!==e})).reduce((function(e,t){var n;return((null===(n=m.a.getPiece(t))||void 0===n?void 0:n.materialValue)||0)+e}),0)},H=function(e,t){var n=e.dataTransfer.getData("text").split("-");console.log(n);var a=Number(n[0]),r=Number(n[1]||-1);if(4!==t&&Math.abs(a)!==m.a.King&&m.a.getPiece(a)){var c=k[t]||m.a.None;console.log(c);var i=Object(f.a)(k).map((function(e,n){return n===t?a:n===r?c:e}));C(i),D(!0),L.current&&(L.current.className="",i.filter((function(e){return 6!==e})).reduce((function(e,t){var n;return((null===(n=m.a.getPiece(t))||void 0===n?void 0:n.materialValue)||0)+e}),0)>31&&setTimeout((function(){L.current&&(L.current.className="invalid")}),0))}};return Object(w.jsxs)("div",{id:"ArmiesBuilderPage",className:"paddedTop",children:[Object(w.jsx)(g.a,{}),Object(w.jsx)("h1",{children:d}),Object(w.jsxs)("div",{className:"armiesManager",children:[Object(w.jsx)("div",{className:"pieceInfoPreview",children:Object(w.jsx)("div",{className:"pieceInfoPreviewBox ".concat(0===R?"noPreview":"preview"),children:0===R?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{className:"faded",children:"Hover over a piece to look at it."}),Object(w.jsx)("p",{className:"faded",children:"Drag pieces to change your army."})]}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h1",{className:"PieceInfo",children:null===(e=m.a.getPiece(R))||void 0===e?void 0:e.longName}),Object(w.jsx)("div",{className:"imgContainer",children:Object(w.jsx)("img",{src:m.a.getImage(R)})}),R===m.a.Pawn?Object(w.jsx)("p",{className:"faded",children:"You cannot change your front row of pawns."}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("br",{}),Object(w.jsx)("br",{})]}),R===m.a.King?Object(w.jsx)("p",{className:"faded",children:"This piece cannot be moved, swapped or altered."}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("br",{}),Object(w.jsx)("br",{})]}),Object(w.jsxs)("p",{className:"info",children:[Object(w.jsx)("b",{children:"Notation:"})," ",null===(t=m.a.getPiece(R))||void 0===t?void 0:t.shortName," ",Object(w.jsx)("br",{}),Object(w.jsx)("b",{children:"Value:"})," ",R===m.a.King?"Infinity":null===(n=m.a.getPiece(R))||void 0===n?void 0:n.materialValue," ",Object(w.jsx)("br",{}),Object(w.jsx)("br",{}),null===(r=m.a.getPiece(R))||void 0===r?void 0:r.movesDescription," ",Object(w.jsx)("br",{}),Object(w.jsx)("br",{}),null===(c=m.a.getPiece(R))||void 0===c?void 0:c.specialMoves.map((function(e,t,n){return Object(w.jsxs)(w.Fragment,{children:[e,t+1===n.length?Object(w.jsxs)(w.Fragment,{children:[" ",Object(w.jsx)("br",{}),Object(w.jsx)("br",{})," "]}):null]})})),null!==(i=m.a.getPiece(R))&&void 0!==i&&i.notes?Object(w.jsxs)(w.Fragment,{children:[null===(o=m.a.getPiece(R))||void 0===o?void 0:o.notes,Object(w.jsx)("br",{}),Object(w.jsx)("br",{})]}):null]}),Object(w.jsxs)("p",{className:"faded",children:["Tags:",null===(l=m.a.getPiece(R))||void 0===l?void 0:l.categories.map((function(e,t,n){return Object(w.jsxs)(w.Fragment,{children:[" ",e,t+1===n.length?"":","]})}))]})]})})}),Object(w.jsx)("div",{className:"piecesList",children:Object(w.jsx)("div",{className:"pieceLibrary",children:m.a.PIECES.filter((function(e){var t;return m.a.getPiece(e)&&-1===(null===(t=m.a.getPiece(e))||void 0===t?void 0:t.categories.indexOf("Token"))})).map((function(e,t){return Object(w.jsx)("div",{className:"libraryPiece",onMouseOver:function(){return B(e)},children:Object(w.jsx)("img",{src:m.a.getImage(e),draggable:e!==m.a.King,onDragStart:function(t){return A(t,e)}})})}))})}),Object(w.jsx)("div",{className:"lowerBoard",children:Object(w.jsxs)("div",{className:"chessBoardPadding",children:[Object(w.jsx)("div",{className:"pointBuyCounter",children:Object(w.jsxs)("p",{children:["Point Buy: ",Object(w.jsxs)("strong",{ref:L,children:[F(),"/31 "]})," "]})}),Object(w.jsxs)("div",{className:"chessBoard",id:"ArmyChessBoard",style:{width:"100%"},children:[function(){for(var e=[],t=0;t<=7;t++)e.push(Object(w.jsx)("div",{style:{left:"".concat(12.5*t,"%")},className:"lowerBoardSquare ".concat(t%2===0?"dark":"light")}));return e}(),k.map((function(e,t){return Object(w.jsx)("div",{className:"lowerBoardPiece",style:{left:"".concat(12.5*t,"%")},onDrop:function(e){return H(e,t)},onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"},children:e===m.a.None?null:Object(w.jsx)("img",{src:m.a.getImage(e),draggable:!0,onDragStart:function(n){return A(n,e,t)},onDragEnd:function(e){return I(e,t)}})})}))]})]})})]}),M?Object(w.jsx)("div",{className:"saveChanges",children:Object(w.jsx)(b.a,{onClick:function(){if(F()>31&&!window.confirm("Your army is over the point buy limit. You will not be able to play with this army. Are you sure you want to save?"))return;var e=localStorage.getItem(p.a);if(e){var t=JSON.parse(e),n=prompt("Choose your army's name",O)||O;n!==O&&delete t[O],t[n]=new h.a(k,n),localStorage.setItem(p.a,JSON.stringify(t)),window.location.href="/armies"}},text:"Save Changes"})}):null]})}function B(){var e=Object(u.i)().url;return Object(w.jsxs)(u.c,{children:[Object(w.jsx)(u.a,{path:"".concat(e),exact:!0,children:Object(w.jsx)(E,{})}),Object(w.jsx)(u.a,{path:"".concat(e,"/:armyID"),children:Object(w.jsx)(R,{})})]})}n(122);function A(){var e=Object(a.useRef)(null);return Object(w.jsxs)("div",{id:"HomepageMain",children:[Object(w.jsx)("h1",{className:"MainTitle",children:"Epic Fantasy Chess"}),Object(w.jsxs)("div",{className:"buttonsRow",children:[Object(w.jsx)(b.a,{onClick:"/play",text:"PLAY",buttonStyle:"medium"}),Object(w.jsx)(b.a,{onClick:"/armies",text:"ARMIES",buttonStyle:"medium"}),Object(w.jsx)(b.a,{onClick:"/decks",text:"DECKS",buttonStyle:"medium"})]}),Object(w.jsx)("div",{className:"infoRow",children:Object(w.jsx)("p",{onMouseDown:function(){e.current&&(e.current.className="shown")},children:"How to play"})}),Object(w.jsxs)("div",{ref:e,className:"hidden",id:"HowToPlayPopup",children:[Object(w.jsx)("div",{id:"PopupBackground"}),Object(w.jsxs)("div",{id:"HowToPlayPopupBubble",children:[Object(w.jsx)("h1",{children:"Welcome to Epic Fantasy Chess!"}),Object(w.jsx)("p",{children:"Chess, but with a twist - or several!"}),Object(w.jsxs)("div",{className:"left section",children:[Object(w.jsx)("h2",{children:"Choose your pieces!"}),Object(w.jsx)("p",{children:"You can build armies from regular chess pieces, plus some fairy ones!"}),Object(w.jsx)("p",{children:"Try out different armies to see what works for your style."}),Object(w.jsxs)("p",{children:["If you see a piece in game and don't know what it does, ",Object(w.jsx)("b",{children:"right-click"})," to find out more!"]}),Object(w.jsx)("div",{id:"ScatteredPieces",children:Object(w.jsx)("img",{src:"./Assets/Misc/scattered-pieces.svg"})})]}),Object(w.jsxs)("div",{className:"right section",children:[Object(w.jsx)("h2",{children:"Play Cards!"}),Object(w.jsxs)("p",{children:["Instead of making a move, you can instead ",Object(w.jsx)("b",{children:"Play Cards!"})," Cards can affect the board, move pieces, or even summon new ones!"]}),Object(w.jsxs)("p",{children:["Cards can be played once their ",Object(w.jsx)("b",{children:"Chaos Score"})," has been reached - after that many points worth of pieces have been captured!"]}),Object(w.jsxs)("p",{children:["Be careful, however - they ",Object(w.jsx)("b",{children:"can't be played while in check!"})]}),Object(w.jsxs)("p",{children:["Some cards are ",Object(w.jsx)("b",{children:"fast"}),". This means you can play them without ending your turn - so you can play another, or make a regular move!"]}),Object(w.jsx)("div",{id:"ScatteredCards",children:Object(w.jsx)("img",{src:"./Assets/Misc/scattered-cards.svg"})})]}),Object(w.jsxs)("div",{className:"left section",children:[Object(w.jsx)("h2",{children:"Pre-made or Customised!"}),Object(w.jsxs)("p",{children:["There are a few ",Object(w.jsx)("b",{children:"pre-made"})," decks and armies for you to try out, or you can make your own with any combination you wish!"]}),Object(w.jsxs)("p",{children:["The ",Object(w.jsx)("b",{children:"FIDE"})," army uses regular pieces, and their deck is ",Object(w.jsx)("b",{children:"balanced"})," with cards to ",Object(w.jsx)("b",{children:"move, promote"})," or even ",Object(w.jsx)("b",{children:"demote"})," pieces!"]}),Object(w.jsxs)("p",{children:["The ",Object(w.jsx)("b",{children:"Colourbound Crusaders"})," use strong pieces stuck on a single colour - with cards to ",Object(w.jsx)("b",{children:"maneuver"})," the board and ",Object(w.jsx)("b",{children:"limit"})," your opponent's choices!"]})]}),Object(w.jsx)("div",{className:"thin section",children:Object(w.jsx)(b.a,{buttonStyle:"medium",onClick:function(){e.current&&(e.current.className="hidden")},text:"Cool!"})})]})]})]})}n(123);var I=n(17);function L(){var e=function(e){var t=localStorage.getItem(p.b);if(t){var n=JSON.parse(t);n[e]&&delete n[e],localStorage.setItem(p.b,JSON.stringify(n)),window.location.reload()}};return Object(w.jsxs)("div",{id:"DecksPage",className:"paddedTop",children:[Object(w.jsx)(g.a,{}),Object(w.jsx)("h1",{className:"pageHeading",children:"Your Decks"}),Object(w.jsx)("p",{className:"pageSubtitle",children:"Where you can view, edit, create and delete decks."}),Object(w.jsx)("p",{className:"pageSubtitle",children:"Click on a deck to edit it, hover over a deck to delete it."}),Object(w.jsx)("div",{className:"decksButtonRow",children:Object(w.jsx)(b.a,{onClick:function(){return function(){var e=localStorage.getItem(p.b),t="";if(e){var n=JSON.parse(e);for(t=prompt("Enter a name for your deck","My Deck")||"My Deck";n[t];)t=prompt("That name has already been chosen")||"My Deck";var a=Object.assign(Object(d.a)({},t,new y.c([],t)),n);localStorage.setItem(p.b,JSON.stringify(a))}else{t=prompt("Enter a name for your deck","My Deck")||"My Deck";var r=Object(d.a)({},t,new y.c([],t));localStorage.setItem(p.b,JSON.stringify(r))}window.location.href="/decks/".concat(t)}()},text:"NEW DECK",buttonStyle:"small"})}),Object(w.jsx)("div",{className:"decksListing",children:function(){var e=[],t=localStorage.getItem(p.b);if(t){var n=JSON.parse(t);Object.keys(n).map((function(t){return e.push(n[t])}))}return e}().map((function(t){return Object(w.jsx)(F,{deck:t,deleteDeck:e})}))})]})}function F(e){var t=e.deck,n=e.deleteDeck,a=function(e){return t.cards.filter((function(t){return t===e})).length};return Object(w.jsxs)("div",{className:"deckPreview",onClick:function(){return window.location.href="/decks/".concat(t.name)},children:[Object(w.jsx)("div",{className:"delete",onClick:function(e){e.stopPropagation(),n(t.name)},children:"\u2716"}),Object(w.jsx)("h3",{className:"DeckName",children:t.name}),Object(w.jsxs)("div",{className:"cards",children:[t.cards.filter((function(e,t,n){return n.indexOf(e)===t})).filter((function(e,t){return t<=3})).map((function(e){return Object(w.jsxs)("p",{children:[I.a[e].cardName||"name error"," x",a(e)]})})),t.cards.filter((function(e,t,n){return n.indexOf(e)===t})).length>4?Object(w.jsx)("p",{children:Object(w.jsx)("i",{children:"Click to view more"})}):null]})]})}n(124);function H(){var e=Object(u.h)().deckId,t=Object(a.useState)(""),n=Object(s.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)([]),o=Object(s.a)(i,2),l=o[0],d=o[1],h=Object(a.useState)(!1),v=Object(s.a)(h,2),j=v[0],m=v[1];Object(a.useLayoutEffect)((function(){var t=localStorage.getItem(p.b);if(t){var n=JSON.parse(t);console.log(n,e),c(n[e].name),d(n[e].cards)}else alert("No deck detected. Redirecting to army menu."),window.location.href="./decks"}),[]);var O=Object(a.useState)(null),x=Object(s.a)(O,2),N=x[0],k=x[1],C=function(e,t,n){k(n),e.dataTransfer&&(e.dataTransfer.setData("text/plain",t),e.dataTransfer.effectAllowed="copyMove")},T=function(){k(null)},S=function(e){if(e.dataTransfer){var t=e.dataTransfer.getData("text/plain");t&&(d("lib"===N?function(e){var n=Object(f.a)(e);return n.push(t),n.sort((function(e,t){return I.a[e].cost-I.a[t].cost}))}:function(e){var n=e.indexOf(t);return[].concat(Object(f.a)(e.slice(0,n)),Object(f.a)(e.slice(n+1,e.length)))}),k(null),j||m(!0))}},M=function(e){return l.filter((function(t){return t===e})).length};return Object(w.jsxs)("div",{id:"DecksBuilderPage",className:"paddedTop",children:[Object(w.jsx)(g.a,{}),Object(w.jsx)("h1",{children:e}),Object(w.jsxs)("div",{className:"decksManager",children:[Object(w.jsx)("div",{className:"cardListPreview",children:Object(w.jsxs)("div",{className:"cardListBox",children:[Object(w.jsx)("h2",{className:"cardListingTitle",children:"Decklist"}),Object(f.a)(l).filter((function(e,t,n){return n.indexOf(e)===t})).map((function(e,t){return Object(w.jsxs)("div",{className:"listedCard",draggable:!0,onDragStart:function(t){return C(t,e,"list")},onDragEnd:T,children:[Object(w.jsxs)("span",{className:"chaosValue",children:["(",I.a[e].cost,")"]}),Object(w.jsx)("span",{className:"cardName",children:I.a[e].cardName}),Object(w.jsxs)("span",{className:"cardQuantity",children:["x",M(e)]})]})})),Object(w.jsxs)("div",{className:"counter",children:[l.length,"/15"]}),"lib"!==N?null:Object(w.jsx)("div",{className:"libDragReceiverOuter",onDrop:S,onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"},children:Object(w.jsx)("div",{className:"dragHereNotice",children:"Drag here to add a card to your deck"})})]})}),Object(w.jsx)("div",{className:"cardsList",children:Object(w.jsxs)("div",{className:"cardLibrary",children:[Object.values(I.a).map((function(e,t){return Object(w.jsxs)("div",{className:"libraryCard ".concat(M(e.id)>=2?"disabled":""),draggable:M(e.id)<2,onDragStart:function(t){return C(t,e.id,"lib")},onDragEnd:T,children:[Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{className:"cardChaosScore",children:[Object(w.jsx)("div",{className:"score",children:e.cost}),Object(w.jsx)("div",{className:"speed",children:e.fast?"Fast":""})]}),Object(w.jsx)("div",{className:"cardTitle",children:e.cardName}),Object(w.jsx)("div",{className:"cardDescription",children:e.description}),Object(w.jsx)("div",{className:"cardExpac",children:e.expac})]}),M(e.id)>=2?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"limitReached limitBackground"}),Object(w.jsx)("div",{className:"limitReached limitText",children:"Maximum number of copies reached"})]}):null]})})),"list"!==N?null:Object(w.jsx)("div",{className:"listDragReceiver",onDrop:S,onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"},children:Object(w.jsx)("div",{className:"dragHereNotice",children:"Drag here to remove a card from your deck"})})]})})]}),j?Object(w.jsx)("div",{className:"saveChanges",children:Object(w.jsx)(b.a,{onClick:function(){var e=!0;15!==l.length&&(e=window.confirm("Your deck has an improper number of cards - you won't be able to play with it. Are you sure you want to continue?"));var t=localStorage.getItem(p.b);if(t&&e){var n=JSON.parse(t),a=prompt("Choose your deck's name",r)||r;a!==r&&delete n[r],n[a]=new y.c(l,a),localStorage.setItem(p.b,JSON.stringify(n)),window.location.href="/decks"}},text:"Save Changes"})}):null]})}function V(){var e=Object(u.i)().url;return Object(w.jsxs)(u.c,{children:[Object(w.jsx)(u.a,{path:"".concat(e),exact:!0,children:Object(w.jsx)(L,{})}),Object(w.jsx)(u.a,{path:"".concat(e,"/:deckId"),children:Object(w.jsx)(H,{})})]})}function _(){var e=Object(u.g)();Object(a.useLayoutEffect)((function(){e.pathname.startsWith("/play/game/")&&e.pathname.length>11?document.body.style.overflow="hidden":document.body.style.overflow="auto"}),[e]);var t=Object(a.useRef)(new RTCPeerConnection(x.a));t.current.onconnectionstatechange=function(){return d(t.current.connectionState)};var n=Object(a.useState)(null),r=Object(s.a)(n,2),c=r[0],i=r[1],o=Object(a.useState)("Not Connected"),l=Object(s.a)(o,2),d=(l[0],l[1]);return Object(w.jsx)(x.b.Provider,{value:{Conn:t.current,Channel:c,initChannel:function(e){if(e)console.log("Adding remote channel ".concat(e.id)),console.log("Current channel: \n",c),console.log("Received channel: \n",e),i(e),console.log("Added remote channel: \n ",c);else{var n=t.current.createDataChannel("data channel");i(n),console.log("Created channel "+n.id)}var a=null===c||void 0===c?void 0:c.id;c&&(c.onopen=function(){console.log("Data channel ".concat(null===c||void 0===c?void 0:c.id," opened!"))},c.onclose=function(){console.log("Data channel ".concat(a," closed!"))},c.onmessage=function(e){console.log("MESSAGE RECEIVED on channel ".concat(a," (Currently listening on ").concat(null===c||void 0===c?void 0:c.id,":"),e)})},setListener:function(e){c?(c.onmessage=e,console.log("Updated event listener")):console.log("Tried to attach listener but no data channel exists.")}},children:Object(w.jsxs)(u.c,{children:[Object(w.jsx)(u.a,{path:"/epic-fantasy-chess/",exact:!0,children:Object(w.jsx)(A,{})}),Object(w.jsx)(u.a,{path:"/epic-fantasy-chess/play",children:Object(w.jsx)(D,{})}),Object(w.jsx)(u.a,{path:"/epic-fantasy-chess/armies",children:Object(w.jsx)(B,{})}),Object(w.jsx)(u.a,{path:"/epic-fantasy-chess/decks",children:Object(w.jsx)(V,{})})]})})}i.a.render(Object(w.jsx)(r.a.StrictMode,{children:Object(w.jsx)(O.a,{children:Object(w.jsx)(_,{})})}),document.getElementById("root")),o()}],[[125,1,2]]]);
//# sourceMappingURL=main.e51ac5b9.chunk.js.map